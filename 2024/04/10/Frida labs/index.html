<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf8" />
    <meta name="viewport" content="initial-scale=1.0, width=device-width" />
    <title>
      
        Fridaæ“ä½œå¤§å…¨ | ä¸´æ±Ÿä»™çš„èŠ±é—´é˜
      
    </title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    
      <link rel="apple-touch-icon"
            sizes="180x180"
            href="/images/apple-touch-icon.png" />
    
    
      <link rel="icon"
            type="image/png"
            sizes="32x32"
            href="/images/logo-32.png" />
    
    
      <link rel="icon"
            type="image/png"
            sizes="16x16"
            href="/images/logo-16.png" />
    
    
      <link rel="mask-icon"
            href="/images/1.svg"
            color="" />
    
    
    
      
  <style>
    @font-face {
        font-family:sourceHanSerif;
        src: url(/font/normal.ttf);
        font-weight: normal;
    }
  </style>

  <style>
    @font-face {
        font-family:sourceHanSerif;
        src: url(/font/bold.ttf);
        font-weight: bold;
    }
  </style>


    
    <link rel="stylesheet"
          type="text/css"
          href='/css/layout.css' />
    
    
  <link rel="stylesheet" type="text/css" href="/css/post.css"/>
  

  <meta name="generator" content="Hexo 7.3.0"></head>
  <body>
    
      <div id="search-mask" style="display:none">
  <div class="search-main" id="search-main">
    <div class="search__head">
      <div class="search-form">
        <svg t="1706347533072"
             class="icon"
             viewBox="0 0 1024 1024"
             version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="7828"
             width="20"
             height="20">
          <path d="M685.6 660.336l155.152 155.168a16 16 0 0 1 0 22.624l-11.312 11.328a16 16 0 0 1-22.624 0l-158.528-158.544a289.792 289.792 0 0 1-165.152 51.36C322.336 742.256 192 611.904 192 451.12 192 290.336 322.336 160 483.136 160c160.784 0 291.12 130.336 291.12 291.136 0 82.112-33.984 156.272-88.672 209.2z m-202.464 33.92c134.272 0 243.12-108.848 243.12-243.12C726.256 316.848 617.408 208 483.136 208 348.848 208 240 316.848 240 451.136c0 134.272 108.848 243.12 243.136 243.12z" fill="#000000" p-id="7829">
          </path>
        </svg>
        <input id="search-input" placeholder="æœç´¢æ–‡ç« ">
        <svg t="1706361500528"
             id="search-clear"
             class="icon"
             viewBox="0 0 1024 1024"
             version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="4351"
             width="20"
             height="20">
          <path d="M512 562.688l-264.2944 264.2944-50.688-50.688L461.312 512 197.0176 247.7056l50.688-50.688L512 461.312l264.2944-264.2944 50.688 50.688L562.688 512l264.2944 264.2944-50.688 50.688L512 562.688z" fill="#00" p-id="4352">
          </path>
        </svg>
      </div>
    </div>
    <div class="search__body" id="search-result"></div>
    <div class="search__foot"></div>
  </div>
</div>

    
    <div class="head">
      <div class="nav">
        <a href='/' class="nav-logo">
          <img alt="logo" height="60px" width="60px" src="/images/1.svg" />
        </a>
        <input id="navBtn" type="checkbox" />
        <div class="nav-right">
          
            <div class="search-outer">
  <div class="search" id="search-btn">
    <svg t="1706347533072"
         class="icon"
         viewBox="0 0 1024 1024"
         version="1.1"
         xmlns="http://www.w3.org/2000/svg"
         p-id="7828"
         width="20"
         height="20">
      <path d="M685.6 660.336l155.152 155.168a16 16 0 0 1 0 22.624l-11.312 11.328a16 16 0 0 1-22.624 0l-158.528-158.544a289.792 289.792 0 0 1-165.152 51.36C322.336 742.256 192 611.904 192 451.12 192 290.336 322.336 160 483.136 160c160.784 0 291.12 130.336 291.12 291.136 0 82.112-33.984 156.272-88.672 209.2z m-202.464 33.92c134.272 0 243.12-108.848 243.12-243.12C726.256 316.848 617.408 208 483.136 208 348.848 208 240 316.848 240 451.136c0 134.272 108.848 243.12 243.136 243.12z" fill="#000000" p-id="7829">
      </path>
    </svg>
    <span>æœç´¢</span>
    <span class="search-shortcut-key">Ctrl K</span>
  </div>
</div>

          
          <div class="nav-menu">
            
              
                <a class="nav-menu-item" href="/feat">å¤æ–‡</a>
              
                <a class="nav-menu-item" href="/base">é€†å‘</a>
              
            
            
          </div>
        </div>
        <label class="nav-btn" for="navBtn"></label>
      </div>
    </div>
    <div class="body">
      
  <article class="post-content">
    <div class="post-inner--toc">
      <div class="post-content__head">
        <div class="post-title">Fridaæ“ä½œå¤§å…¨</div>
        <div class="post-info">
          
  <a href="/tags/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/" class="post-tag">#ç§»åŠ¨å®‰å…¨</a>


          <span class="post-date">2024-04-10</span>
        </div>
      </div>
      
        <aside class="toc-outer">
          <div class="toc-title">ç›®å½•</div>
          <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Frida-labs"><span class="post-toc-text">Frida labs</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8F%82%E6%95%B0%E8%A7%A3%E9%87%8A"><span class="post-toc-text">å‚æ•°è§£é‡Š</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x1-Hook%E4%BF%AE%E6%94%B9%E8%A2%AB%E8%B0%83%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95%E7%9A%84%E9%80%BB%E8%BE%91%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%80%BC%EF%BC%8C%E4%BC%A0%E5%85%A5%E5%8F%82%E6%95%B0"><span class="post-toc-text">0x1 Hookä¿®æ”¹è¢«è°ƒç”¨çš„æ–¹æ³•çš„é€»è¾‘ï¼Œè¿”å›å€¼ï¼Œä¼ å…¥å‚æ•°</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x2-Hook%E8%B0%83%E7%94%A8%E9%9D%99%E6%80%81%E7%9A%84%E6%9C%AA%E8%A2%AB%E8%B0%83%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95"><span class="post-toc-text">0x2 Hookè°ƒç”¨é™æ€çš„æœªè¢«è°ƒç”¨çš„æ–¹æ³•</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x3-%E6%9B%B4%E6%94%B9%E7%B1%BB%E4%B8%AD%E7%9A%84%E9%9D%99%E6%80%81%E5%8F%98%E9%87%8F"><span class="post-toc-text">0x3 æ›´æ”¹ç±»ä¸­çš„é™æ€å˜é‡</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#a-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="post-toc-text">a æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%B1%BB%E6%AF%94%E4%B8%80%E4%B8%8B%EF%BC%9A"><span class="post-toc-text">ç±»æ¯”ä¸€ä¸‹ï¼š</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%9B%B4%E5%85%B7%E4%BD%93%E5%9C%B0%E8%AF%B4%EF%BC%9A"><span class="post-toc-text">æ›´å…·ä½“åœ°è¯´ï¼š</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%89%80%E4%BB%A5%E6%80%BB%E7%BB%93%E4%B8%80%E4%B8%8B%EF%BC%9A"><span class="post-toc-text">æ‰€ä»¥æ€»ç»“ä¸€ä¸‹ï¼š</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x4-%E8%B0%83%E7%94%A8%E9%9D%9EMainActivity-%E9%9D%9E%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="post-toc-text">0x4 è°ƒç”¨éMainActivity,éé™æ€æ–¹æ³•</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x5-%E8%B0%83%E7%94%A8MainActivity%E4%B8%AD%E7%9A%84%E9%9D%9E%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="post-toc-text">0x5 è°ƒç”¨MainActivityä¸­çš„éé™æ€æ–¹æ³•</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%F0%9F%93%B1-%E6%AD%A3%E5%B8%B8%E6%9D%A5%E8%AF%B4%EF%BC%8CAndroid-%E5%BA%94%E7%94%A8%E6%98%AF%E6%80%8E%E4%B9%88%E5%90%AF%E5%8A%A8%E7%9A%84%EF%BC%9F"><span class="post-toc-text">ğŸ“± æ­£å¸¸æ¥è¯´ï¼ŒAndroid åº”ç”¨æ˜¯æ€ä¹ˆå¯åŠ¨çš„ï¼Ÿ</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%F0%9F%A7%A0-%E9%82%A3%E8%BF%99%E6%AE%B5%E8%AF%9D%E7%9A%84%E6%A0%B8%E5%BF%83%E6%84%8F%E6%80%9D%E5%B0%B1%E6%98%AF%EF%BC%9A"><span class="post-toc-text">ğŸ§  é‚£è¿™æ®µè¯çš„æ ¸å¿ƒæ„æ€å°±æ˜¯ï¼š</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E2%9C%85-%E6%80%BB%E7%BB%93%E4%B8%80%E4%B8%8B%EF%BC%8C%E9%80%9A%E4%BF%97%E7%82%B9%E8%AF%B4%E5%B0%B1%E6%98%AF%EF%BC%9A"><span class="post-toc-text">âœ… æ€»ç»“ä¸€ä¸‹ï¼Œé€šä¿—ç‚¹è¯´å°±æ˜¯ï¼š</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x6-MainActivity%E4%B8%AD%E7%9A%84%E9%9D%9E%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E4%B8%94%E5%8F%82%E6%95%B0%E9%80%9A%E8%BF%87%E9%9D%9EMainActivity%E9%9D%9E%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E4%BC%A0%E9%80%92"><span class="post-toc-text">0x6 MainActivityä¸­çš„éé™æ€æ–¹æ³•ä¸”å‚æ•°é€šè¿‡éMainActivityéé™æ€æ–¹æ³•ä¼ é€’</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x7-Hook%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="post-toc-text">0x7 Hookæ„é€ å‡½æ•°</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x8-Hook-Native%E5%B1%82%E4%B8%AD%E8%B0%83%E7%94%A8%E7%9A%84%E5%87%BD%E6%95%B0%E5%B9%B6%E4%B8%94%E8%AF%BB%E5%8F%96%E4%BC%A0%E5%85%A5%E7%9A%84%E5%8F%82%E6%95%B0"><span class="post-toc-text">0x8 Hook Nativeå±‚ä¸­è°ƒç”¨çš„å‡½æ•°å¹¶ä¸”è¯»å–ä¼ å…¥çš„å‚æ•°</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x9-Hook-Native%E5%B1%82%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="post-toc-text">0x9 Hook Nativeå±‚å‡½æ•°çš„è¿”å›å€¼</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0xA-Hook-Native%E5%B1%82%E6%9C%AA%E8%A2%AB%E8%B0%83%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95"><span class="post-toc-text">0xA Hook Nativeå±‚æœªè¢«è°ƒç”¨çš„æ–¹æ³•</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0xB-%E6%9B%B4%E6%94%B9Native%E5%B1%82%E7%9A%84%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4"><span class="post-toc-text">0xB æ›´æ”¹Nativeå±‚çš„æ±‡ç¼–æŒ‡ä»¤</span></a></li></ol></li></ol>
          <a href="#" class="toc-top">å›åˆ°é¡¶éƒ¨</a>
        </aside>
      
      <div class="post-content__body">
        
          <div class="post-gallery">
            
          </div>
        
        <p>Frida Labså…¨è§£</p>
<span id="more"></span>
<h1 id="Frida-labs"><a href="#Frida-labs" class="headerlink" title="Frida labs"></a>Frida labs</h1><h2 id="å‚æ•°è§£é‡Š"><a href="#å‚æ•°è§£é‡Š" class="headerlink" title="å‚æ•°è§£é‡Š"></a>å‚æ•°è§£é‡Š</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">-U æŒ‡å®š<span class="hljs-variable constant_">USB</span>è®¾å¤‡<br>-f æŒ‡å®šappåŒ…åï¼Œé€šè¿‡spawnæ–¹å¼å¯åŠ¨ï¼ˆå°±æ˜¯é‡æ–°å¯åŠ¨çš„æ„æ€ï¼‰<br>-P æŒ‡å®š<span class="hljs-variable constant_">APP</span>çš„pid<br>--no-pause ä¸æš‚åœ<br>-l åŠ è½½hookè„šæœ¬<br></code></pre></td></tr></table></figure>

<p>â€</p>
<h2 id="0x1-Hookä¿®æ”¹è¢«è°ƒç”¨çš„æ–¹æ³•çš„é€»è¾‘ï¼Œè¿”å›å€¼ï¼Œä¼ å…¥å‚æ•°"><a href="#0x1-Hookä¿®æ”¹è¢«è°ƒç”¨çš„æ–¹æ³•çš„é€»è¾‘ï¼Œè¿”å›å€¼ï¼Œä¼ å…¥å‚æ•°" class="headerlink" title="0x1 Hookä¿®æ”¹è¢«è°ƒç”¨çš„æ–¹æ³•çš„é€»è¾‘ï¼Œè¿”å›å€¼ï¼Œä¼ å…¥å‚æ•°"></a>0x1 Hookä¿®æ”¹è¢«è°ƒç”¨çš„æ–¹æ³•çš„é€»è¾‘ï¼Œè¿”å›å€¼ï¼Œä¼ å…¥å‚æ•°</h2><p>ä½¿ç”¨éšæœºæ•°ï¼Œå¯¹è¾“å…¥è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœè¾“å…¥æ•°çš„æ»¡è¶³ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå°±ä¼šæ‰“å°å‡ºflag</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413221718.png" alt="image"></p>
<p>äºæ˜¯è¿™é‡Œå°±æœ‰ä¸¤ç§æ€è·¯äº†ã€‚ç¬¬ä¸€ç§æ˜¯ hook get_random å‡½æ•°ï¼Œè®©è¯¥å‡½æ•°çš„è¿”å›å€¼å˜æˆä¸€ä¸ªå›ºå®šçš„å€¼ï¼Œä»è€Œè®¡ç®—è¡¨è¾¾å¼çš„å€¼</p>
<p>ç¬¬äºŒç§æ€è·¯æ˜¯ hook check å‡½æ•°ï¼Œç›´æ¥å°†æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å€¼ä¼ å…¥è¿›å»</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x1.MainActivity&quot;</span>); <span class="hljs-comment">//ä½¿ç”¨ Frida çš„ Java.use() æ–¹æ³•è·å–ç›®æ ‡ç±» MainActivity çš„å¼•ç”¨ã€‚</span><br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-property">get_random</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; <span class="hljs-comment">//implementation åœ¨ Frida ä¸­æ˜¯ä¸€ä¸ªå…³é”®å±æ€§ï¼Œç”¨äºè¦†ç›–åŸå§‹ Java æ–¹æ³•çš„å®ç°</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook2</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x1.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-property">check</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;int&#x27;</span>, <span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) &#123; <span class="hljs-comment">//overloadç”¨äºæŒ‡å®šå‚æ•°ï¼Œç”±äºJavaçš„æ–¹æ³•å¯ä»¥é‡è½½ï¼Œæ‰€ä»¥éœ€è¦æŒ‡å®š</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Origin i and i2 = &quot;</span>, a, b); <span class="hljs-comment">//console.logæ‰“å°</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">check</span>(<span class="hljs-number">3</span>, b); <span class="hljs-comment">//æˆ‘ä»¬è‡ªå·±å°† i çš„å€¼å®šä¸º 3 ä¼ å…¥è¿›å»</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook2</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p>æ³¨å…¥</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">frida -U -f com.<span class="hljs-property">ad2001</span>.<span class="hljs-property">frida0x1</span> -l hook.<span class="hljs-property">js</span><br></code></pre></td></tr></table></figure>

<p>-U -f ç¼ºä¸€ä¸å¯</p>
<p>ä¸ºä»€ä¹ˆ</p>
<p>ç¼ºå°‘ -f</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">C:\Users\29660\Desktop\Frida\Frida-Labs-main\Frida-Labs-main\Frida 0x1&gt;frida -U com.ad2001.frida0x1 -l hook.js<br>     ____<br>    / _  |   Frida 16.4.10 - A world-class dynamic instrumentation toolkit<br>   | (_| |<br>    &gt; _  |   Commands:<br>   /_/ |_|       <span class="hljs-built_in">help</span>      -&gt; Displays the <span class="hljs-built_in">help</span> system<br>   . . . .       object?   -&gt; Display information about <span class="hljs-string">&#x27;object&#x27;</span><br>   . . . .       <span class="hljs-built_in">exit</span>/quit -&gt; Exit<br>   . . . .<br>   . . . .   More info at https://frida.re/docs/home/<br>   . . . .<br>   . . . .   Connected to Android Emulator 5554 (<span class="hljs-built_in">id</span>=emulator-5554)<br>Failed to spawn: unable to find process with name <span class="hljs-string">&#x27;com.ad2001.frida0x1&#x27;</span> <br></code></pre></td></tr></table></figure>

<p>Failed to spawn: unable to find process with name â€˜com.ad2001.frida0x1â€™è¡¨ç¤ºæ²¡æœ‰Frida <strong>æ‰¾ä¸åˆ°åä¸º</strong> <strong>â€‹<code>com.ad2001.frida0x1</code>â€‹</strong> <strong>çš„è¿›ç¨‹ï¼Œè¯¦è§lab02</strong></p>
<p>â€</p>
<p>ç¼ºå°‘-U</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">C:\Users\29660\Desktop\Frida\Frida-Labs-main\Frida-Labs-main\Frida 0x1&gt;frida -f com.ad2001.frida0x1 -l hook.js<br>     ____<br>    / _  |   Frida 16.4.10 - A world-class dynamic instrumentation toolkit<br>   | (_| |<br>    &gt; _  |   Commands:<br>   /_/ |_|       <span class="hljs-built_in">help</span>      -&gt; Displays the <span class="hljs-built_in">help</span> system<br>   . . . .       object?   -&gt; Display information about <span class="hljs-string">&#x27;object&#x27;</span><br>   . . . .       <span class="hljs-built_in">exit</span>/quit -&gt; Exit<br>   . . . .<br>   . . . .   More info at https://frida.re/docs/home/<br>   . . . .<br>   . . . .   Connected to Local System (<span class="hljs-built_in">id</span>=<span class="hljs-built_in">local</span>)<br>Failed to spawn: unable to find executable at <span class="hljs-string">&#x27;com.ad2001.frida0x1&#x27;</span><br></code></pre></td></tr></table></figure>

<p>è¯´æ˜ Frida <strong>æ²¡æœ‰è¿æ¥åˆ° Android æ¨¡æ‹Ÿå™¨</strong>ï¼Œè€Œæ˜¯è¿æ¥åˆ°äº†ä½ æœ¬åœ°ç”µè„‘ï¼ˆWindowsï¼‰ï¼Œæ‰€ä»¥å®ƒä»¥ä¸ºæ˜¯è¦åœ¨æœ¬åœ°è¿è¡Œä¸€ä¸ªå« <code>com.ad2001.frida0x1</code> çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>
<p>â€</p>
<h2 id="0x2-Hookè°ƒç”¨é™æ€çš„æœªè¢«è°ƒç”¨çš„æ–¹æ³•"><a href="#0x2-Hookè°ƒç”¨é™æ€çš„æœªè¢«è°ƒç”¨çš„æ–¹æ³•" class="headerlink" title="0x2 Hookè°ƒç”¨é™æ€çš„æœªè¢«è°ƒç”¨çš„æ–¹æ³•"></a>0x2 Hookè°ƒç”¨é™æ€çš„æœªè¢«è°ƒç”¨çš„æ–¹æ³•</h2><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ª get_flag æ–¹æ³•ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰åœ¨ä¸»å‡½æ•°ä¸­è¢«è°ƒç”¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413222107.png" alt="image"></p>
<p>ä½¿ç”¨ frida ç›´æ¥è°ƒç”¨æœªè¢«è°ƒç”¨çš„é™æ€æ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">setImmediate</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><br>        <span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x2.MainActivity&quot;</span>)<br>        a.<span class="hljs-title function_">get_flag</span>(<span class="hljs-number">4919</span>);<br><br>    &#125;)<br><br>&#125;)<br><br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x2.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-title function_">get_flag</span>(<span class="hljs-number">4919</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p>hookçš„æ—¶å€™ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æœ‰å¯èƒ½ä¼šhookä¸ä¸Š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">frida -U -f com.<span class="hljs-property">ad2001</span>.<span class="hljs-property">frida0x2</span> -l hook.<span class="hljs-property">js</span><br></code></pre></td></tr></table></figure>

<p>åŸå› æ˜¯setImmediate(main);æ˜¯ç¨‹åºå¯åŠ¨åç«‹å³æ³¨å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºè¿˜æ²¡å®Œå…¨å¯åŠ¨å°±æ³¨å…¥äº†ï¼Œæ‰€ä»¥hookä¸ä¸Š</p>
<p>è§£å†³åŠæ³•æ˜¯ä½¿ç”¨</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">frida -U <span class="hljs-string">&#x27;frida 0x2&#x27;</span> -l hook.<span class="hljs-property">js</span><br></code></pre></td></tr></table></figure>

<p>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆå°†frida 0x2å†™æˆåŒ…åcom.ad2001.frida0x2å°±ä¸è¡Œå‘¢</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">frida -U com.<span class="hljs-property">ad2001</span>.<span class="hljs-property">frida0x2</span> -l hook.<span class="hljs-property">js</span><br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250411160833.png" alt="image"></p>
<p>è¿™ä¸ªå‘½ä»¤å°è¯•çš„æ˜¯ï¼š<strong>æ ¹æ®åŒ…åæ³¨å…¥ï¼Œé»˜è®¤æ˜¯ spawnï¼ˆå¯åŠ¨ï¼‰æ¨¡å¼</strong>ã€‚</p>
<p>å®é™…ä¸Šè¿™æ¡å‘½ä»¤æ˜¯å°è¯• <strong>spawnï¼ˆå¯åŠ¨ï¼‰åŒ…åå¯¹åº”çš„ app</strong>ï¼Œä½†æ²¡å†™ <code>-f</code>ï¼Œå®ƒåˆä¸æ˜¯ attach æ¨¡å¼ï¼Œå°±ä¼šå¤±è´¥ã€‚</p>
<p>æˆ–è€…å°†hookä»£ç ä¸­çš„</p>
<p>setImmediate(main);æ”¹æˆ</p>
<p>setTimeout(main,1000);å»¶è¿Ÿå¯åŠ¨</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x2.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-title function_">get_flag</span>(<span class="hljs-number">4919</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-comment">// setImmediate(main);</span><br><span class="hljs-built_in">setTimeout</span>(main, <span class="hljs-number">1000</span>);<br></code></pre></td></tr></table></figure>

<p>â€</p>
<h2 id="0x3-æ›´æ”¹ç±»ä¸­çš„é™æ€å˜é‡"><a href="#0x3-æ›´æ”¹ç±»ä¸­çš„é™æ€å˜é‡" class="headerlink" title="0x3 æ›´æ”¹ç±»ä¸­çš„é™æ€å˜é‡"></a>0x3 æ›´æ”¹ç±»ä¸­çš„é™æ€å˜é‡</h2><p>hook codeçš„å€¼</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250411171349.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br>    <br>    <span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x3.Checker&quot;</span>) <span class="hljs-comment">//codeçš„å€¼åœ¨Checkerç±»é‡Œ</span><br>    a.<span class="hljs-property">code</span>.<span class="hljs-property">value</span> = <span class="hljs-number">512</span>; <span class="hljs-comment">//ä½¿ç”¨è¿™ä¸€å¥ä¿®æ”¹é™æ€å˜é‡çš„å€¼</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p>æ€è€ƒï¼š</p>
<p>aæ˜¯ä»€ä¹ˆ</p>
<p>a.code.valueå…·ä½“æ˜¯ä»€ä¹ˆæ„æ€</p>
<p>ä»¥ä¸‹å†…å®¹æ¥è‡ªGPT</p>
<blockquote>
<p>åœ¨è¿™æ®µ Frida è„šæœ¬ä¸­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x3.Checker&quot;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="a-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#a-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="a æ˜¯ä»€ä¹ˆï¼Ÿ"></a><code>a</code> æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ğŸ‘‰ <strong>â€‹<code>a</code>â€‹</strong> <strong>æ˜¯ä¸€ä¸ª Frida åˆ›å»ºçš„ Java ç±»ä»£ç†å¯¹è±¡ï¼ˆJava class wrapperï¼‰</strong> ï¼Œä½ å¯ä»¥æŠŠå®ƒå½“æˆæ˜¯ä¸€ä¸ªâ€œæ§åˆ¶å™¨â€æˆ–è€…â€œä»£ç†â€ï¼Œç”¨æ¥è®¿é—®å’Œæ“ä½œ Java ä¸­çš„ç±» <code>com.ad2001.frida0x3.Checker</code> çš„é™æ€å­—æ®µã€é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•ï¼Œç”šè‡³å¯ä»¥ hook å®ƒçš„æ–¹æ³•ã€‚</p>
<hr>
<h3 id="ç±»æ¯”ä¸€ä¸‹ï¼š"><a href="#ç±»æ¯”ä¸€ä¸‹ï¼š" class="headerlink" title="ç±»æ¯”ä¸€ä¸‹ï¼š"></a>ç±»æ¯”ä¸€ä¸‹ï¼š</h3><p>åœ¨ Java ä»£ç ä¸­ä½ å¯èƒ½ä¼šè¿™æ ·ç”¨ä¸€ä¸ªç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Checker.code = <span class="hljs-number">512</span>;<br></code></pre></td></tr></table></figure>

<p>åœ¨ Frida ä¸­ï¼Œä¸ºäº†è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæœï¼Œæˆ‘ä»¬å†™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x3.Checker&quot;</span>)<br>a.<span class="hljs-property">code</span>.<span class="hljs-property">value</span> = <span class="hljs-number">512</span>;<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="æ›´å…·ä½“åœ°è¯´ï¼š"><a href="#æ›´å…·ä½“åœ°è¯´ï¼š" class="headerlink" title="æ›´å…·ä½“åœ°è¯´ï¼š"></a>æ›´å…·ä½“åœ°è¯´ï¼š</h3><ul>
<li><p>â€‹<code>Java.use(&quot;...&quot;)</code> ä¼šè¿”å›ä¸€ä¸ª <strong>Frida çš„ Java ç±»æ¥å£ï¼ˆwrapperï¼‰</strong></p>
</li>
<li><p>è¿™ä¸ªå¯¹è±¡ä¸æ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯ä»¥æ“ä½œ <strong>ç±»æœ¬èº«ï¼ˆé™æ€æˆå‘˜ï¼‰æˆ–åˆ›å»ºå®ä¾‹</strong> çš„å¯¹è±¡ã€‚</p>
</li>
<li><p>å¦‚æœä½ éœ€è¦åˆ›å»ºç±»çš„å®ä¾‹ï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> instance = a.$new();  <span class="hljs-comment">// ç­‰äº Java é‡Œçš„ new Checker()</span><br></code></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="æ‰€ä»¥æ€»ç»“ä¸€ä¸‹ï¼š"><a href="#æ‰€ä»¥æ€»ç»“ä¸€ä¸‹ï¼š" class="headerlink" title="æ‰€ä»¥æ€»ç»“ä¸€ä¸‹ï¼š"></a>æ‰€ä»¥æ€»ç»“ä¸€ä¸‹ï¼š</h3><table>
<thead>
<tr>
<th>åç§°</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody><tr>
<td>â€‹<code>a</code>â€‹</td>
<td>Frida ä¸­çš„ç±»åŒ…è£…å¯¹è±¡ï¼Œè¡¨ç¤º<code>Checker</code>ç±»</td>
</tr>
<tr>
<td>â€‹<code>a.code.value</code>â€‹</td>
<td>è¡¨ç¤ºè®¿é—®å¹¶ä¿®æ”¹ç±»ä¸­<code>code</code>è¿™ä¸ªé™æ€å­—æ®µçš„å€¼</td>
</tr>
<tr>
<td>â€‹<code>a.$new()</code>â€‹</td>
<td>ï¼ˆå¯é€‰ï¼‰è¡¨ç¤ºåˆ›å»ºè¿™ä¸ªç±»çš„ä¸€ä¸ªæ–°å®ä¾‹</td>
</tr>
</tbody></table>
</blockquote>
<p>â€</p>
<h2 id="0x4-è°ƒç”¨éMainActivity-éé™æ€æ–¹æ³•"><a href="#0x4-è°ƒç”¨éMainActivity-éé™æ€æ–¹æ³•" class="headerlink" title="0x4 è°ƒç”¨éMainActivity,éé™æ€æ–¹æ³•"></a>0x4 è°ƒç”¨éMainActivity,éé™æ€æ–¹æ³•</h2><p>â€‹<code>MainActivity</code>é‡Œæ²¡æœ‰ä»»ä½•ä¸œè¥¿</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250412170532.png" alt="image"></p>
<p>å®šä¹‰äº†ä¸€ä¸ªCheckç±»ï¼Œé‡Œé¢æœ‰get_flagæ–¹æ³•</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250412170610.png" alt="image"></p>
<p>æƒ³è°ƒç”¨è¿™ä¸ªget_flagæ–¹æ³•ï¼Œå¿…é¡»å®ä¾‹åŒ–ä¸€ä¸ªcheckç±»å¯¹è±¡ï¼Œåœ¨fridaä¸­å¯ä»¥ç”¨ä»¥ä¸‹è„šæœ¬å®ç°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br>    <br>    <span class="hljs-keyword">var</span> c = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x4.Check&quot;</span>);<br>    <span class="hljs-keyword">var</span> c_check = c.$new();   <span class="hljs-comment">//å®ä¾‹åŒ–checkç±»å¯¹è±¡ ç›¸å½“äºJavaé‡Œå†™ c c_check = new c();</span><br> <br>    <span class="hljs-keyword">var</span> flag = c_check.<span class="hljs-title function_">get_flag</span>(<span class="hljs-number">1337</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(flag);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœå¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250412170950.png" alt="image"></p>
<h2 id="0x5-è°ƒç”¨MainActivityä¸­çš„éé™æ€æ–¹æ³•"><a href="#0x5-è°ƒç”¨MainActivityä¸­çš„éé™æ€æ–¹æ³•" class="headerlink" title="0x5 è°ƒç”¨MainActivityä¸­çš„éé™æ€æ–¹æ³•"></a>0x5 è°ƒç”¨MainActivityä¸­çš„éé™æ€æ–¹æ³•</h2><p>åœ¨ 0x2 ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨fridaè°ƒç”¨äº†é™æ€æ–¹æ³•</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413192625.png" alt="image"></p>
<p>ä½†åœ¨æœ¬æ¬¡ï¼Œè¿™æ˜¯ä¸€ä¸ªéé™æ€æ–¹æ³•</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413192705.png" alt="image"></p>
<p>Javaä¸­é™æ€æ–¹æ³•å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œè€Œéé™æ€æ–¹æ³•å¿…é¡»å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ä¹‹åæ‰èƒ½è°ƒç”¨</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js">public <span class="hljs-keyword">class</span> <span class="hljs-title class_">Hello</span> &#123;<br><br>    <span class="hljs-comment">// é™æ€æ–¹æ³•</span><br>    public <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayStatic</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;æˆ‘æ˜¯é™æ€æ–¹æ³•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// éé™æ€æ–¹æ³•</span><br>    public <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayInstance</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;æˆ‘æ˜¯éé™æ€æ–¹æ³•&quot;</span>);<br>    &#125;<br><br>    public <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) &#123;<br>        <span class="hljs-comment">// è°ƒç”¨é™æ€æ–¹æ³•ï¼šä¸éœ€è¦åˆ›å»ºå¯¹è±¡</span><br>        <span class="hljs-title class_">Hello</span>.<span class="hljs-title function_">sayStatic</span>();<br><br>        <span class="hljs-comment">// è°ƒç”¨éé™æ€æ–¹æ³•ï¼šå¿…é¡»å…ˆåˆ›å»ºå¯¹è±¡</span><br>        <span class="hljs-title class_">Hello</span> h = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hello</span>();<br>        h.<span class="hljs-title function_">sayInstance</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ç›´æ¥ç”¨ 0x2 çš„è„šæœ¬hookä¸€ä¸‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x5.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-title function_">flag</span>(<span class="hljs-number">1337</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p>å“¦è±ï¼ŒæŠ¥é”™äº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413194308.png" alt="image"></p>
<p>ä»¥ä¸‹è§£é‡Šæ¥è‡ªSWDDå¸ˆå‚…</p>
<blockquote>
<p>ç›´æ¥ä½¿ç”¨Fridaåˆ›å»ºMainActivityæˆ–ä»»ä½•Androidç»„ä»¶å¯èƒ½ä¼šå¾ˆæ£˜æ‰‹ï¼Œå› ä¸ºAndroidçš„ç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹è§„åˆ™ã€‚Androidç»„ä»¶ï¼Œå¦‚Activityå­ç±»ï¼Œä¾èµ–äºåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡è¿›è¡Œæ­£ç¡®è¿è¡Œã€‚åœ¨Fridaä¸­ï¼Œæ‚¨å¯èƒ½ç¼ºå°‘å¿…è¦çš„ä¸Šä¸‹æ–‡ã€‚Android UIç»„ä»¶é€šå¸¸éœ€è¦å…·æœ‰å…³è”Looperçš„ç‰¹å®šçº¿ç¨‹ã€‚å¦‚æœæ¶‰åŠUIä»»åŠ¡ï¼Œè¯·ç¡®ä¿åœ¨å…·æœ‰æ´»åŠ¨Looperçš„ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚æ´»åŠ¨æ˜¯è¾ƒå¤§çš„Androidåº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸçš„ä¸€éƒ¨åˆ†ã€‚åˆ›å»ºMainActivityçš„å®ä¾‹å¯èƒ½éœ€è¦åº”ç”¨å¤„äºç‰¹å®šçŠ¶æ€ï¼Œå¹¶ä¸”é€šè¿‡Fridaç®¡ç†æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå¯èƒ½å¹¶ä¸ç›´æ¥ã€‚æ€»ä¹‹ï¼Œä¸ºMainActivityåˆ›å»ºå®ä¾‹å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚</p>
</blockquote>
<p>é€šä¿—ç‚¹æ¥è¯´å°±æ˜¯ï¼Œ</p>
<blockquote>
<p><strong>ç”¨Fridaç›´æ¥åˆ›å»º MainActivity æˆ–å…¶ä»– Android ç»„ä»¶ï¼ˆæ¯”å¦‚ Activityï¼‰æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œç”šè‡³æ˜¯ä¸å¯è¡Œçš„ã€‚</strong></p>
</blockquote>
<p>åŸå› æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li><strong>Activity éœ€è¦ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰æ‰èƒ½æ­£å¸¸å·¥ä½œ</strong>ï¼šå°±åƒä½ é€ æˆ¿å­è¦æœ‰åœ°åŸºä¸€æ ·ï¼ŒActivity è¿™ç§ç»„ä»¶è¿è¡Œçš„æ—¶å€™ï¼Œéœ€è¦ä¾èµ–åº”ç”¨ç¨‹åºæä¾›çš„è¿è¡Œç¯å¢ƒï¼ˆå°±æ˜¯ Contextï¼‰ã€‚åœ¨ Frida é‡Œï¼Œä½ æ˜¯â€œæ—è§‚è€…â€ï¼Œè€Œä¸æ˜¯â€œæˆ¿å­çš„ä¸»äººâ€ï¼Œæ‰€ä»¥æ²¡æ³•è½»æ¾æä¾›è¿™ä¸ªç¯å¢ƒã€‚</li>
<li><strong>UI ç›¸å…³çš„ä»£ç å¿…é¡»åœ¨ä¸»çº¿ç¨‹ï¼ˆå¸¦ Looper çš„çº¿ç¨‹ï¼‰é‡Œè·‘</strong>ï¼šAndroid è¦æ±‚æ‰€æœ‰è·Ÿç•Œé¢æœ‰å…³çš„æ“ä½œéƒ½å¾—åœ¨â€œä¸»çº¿ç¨‹â€é‡Œè¿è¡Œï¼Œè¿™ä¸ªçº¿ç¨‹æœ‰ä¸ªå« Looper çš„æ¶ˆæ¯å¾ªç¯ç³»ç»Ÿã€‚åœ¨ Frida é‡Œï¼Œå¦‚æœä½ éšä¾¿åœ¨å“ªä¸ªçº¿ç¨‹é‡Œè·‘ UI ä»£ç ï¼Œç¨‹åºå¾ˆå¯èƒ½ç›´æ¥å´©æ‰ã€‚</li>
<li><strong>Activity çš„ç”Ÿå‘½å‘¨æœŸå¾ˆå¤æ‚</strong>ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨å¸® Activity è°ƒç”¨ä¸€ç³»åˆ—æ–¹æ³•ï¼Œæ¯”å¦‚ onCreateã€onStartã€onResume ç­‰ã€‚è¿™ä¸€æ•´å¥—æµç¨‹æ˜¯ç³»ç»Ÿæ§åˆ¶çš„ã€‚å¦‚æœä½ è‡ªå·±ç”¨ Frida å»â€œå¼ºè¡Œâ€åˆ›å»ºä¸€ä¸ª Activity å®ä¾‹ï¼Œç³»ç»Ÿå…¶å®å¹¶ä¸çŸ¥é“å®ƒå­˜åœ¨ï¼Œæ‰€ä»¥å®ƒæ— æ³•æ­£å¸¸å·¥ä½œã€‚</li>
</ol>
<p>é‚£ä¹ˆåº”è¯¥æ€ä¹ˆåŠå‘¢</p>
<p>SWDDè¯´</p>
<blockquote>
<p>å½“Androidåº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œç³»ç»Ÿä¼šåˆ›å»ºMainActivityçš„ä¸€ä¸ªå®ä¾‹ï¼ˆæˆ–AndroidManifest.xmlæ–‡ä»¶ä¸­æŒ‡å®šçš„å¯åŠ¨å™¨æ´»åŠ¨ï¼‰ã€‚åˆ›å»ºMainActivityå®ä¾‹æ˜¯Androidåº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸçš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨fridaè·å–MainActivityçš„å®ä¾‹ï¼Œç„¶åè°ƒç”¨flag()æ–¹æ³•æ¥è·å–æˆ‘ä»¬çš„æ ‡å¿—ã€‚</p>
</blockquote>
<p>è®©æˆ‘ä»¬çœ‹çœ‹GPTæ€ä¹ˆè¯´</p>
<blockquote>
<hr>
<h2 id="ğŸ“±-æ­£å¸¸æ¥è¯´ï¼ŒAndroid-åº”ç”¨æ˜¯æ€ä¹ˆå¯åŠ¨çš„ï¼Ÿ"><a href="#ğŸ“±-æ­£å¸¸æ¥è¯´ï¼ŒAndroid-åº”ç”¨æ˜¯æ€ä¹ˆå¯åŠ¨çš„ï¼Ÿ" class="headerlink" title="ğŸ“± æ­£å¸¸æ¥è¯´ï¼ŒAndroid åº”ç”¨æ˜¯æ€ä¹ˆå¯åŠ¨çš„ï¼Ÿ"></a>ğŸ“± æ­£å¸¸æ¥è¯´ï¼ŒAndroid åº”ç”¨æ˜¯æ€ä¹ˆå¯åŠ¨çš„ï¼Ÿ</h2><ol>
<li>å½“ä½ ç‚¹å‡»æŸä¸ª App å›¾æ ‡æ—¶ï¼Œ</li>
<li>Android ç³»ç»Ÿå°±ä¼šå»çœ‹è¿™ä¸ª App çš„ <code>AndroidManifest.xml</code> æ–‡ä»¶ï¼Œ</li>
<li>æ‰¾åˆ°æ ‡æ³¨ä¸ºã€Œå¯åŠ¨å…¥å£ã€çš„ Activityï¼ˆæ¯”å¦‚ <code>MainActivity</code>ï¼‰ï¼Œ</li>
<li>ç„¶åç³»ç»Ÿä¼š<strong>è‡ªåŠ¨åˆ›å»ºè¿™ä¸ª Activity çš„å®ä¾‹</strong>ï¼Œå¹¶è°ƒç”¨å®ƒçš„ä¸€ç³»åˆ—ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ˆæ¯”å¦‚ <code>onCreate()</code>ã€<code>onResume()</code> ç­‰ï¼‰ã€‚</li>
</ol>
<hr>
<h2 id="ğŸ§ -é‚£è¿™æ®µè¯çš„æ ¸å¿ƒæ„æ€å°±æ˜¯ï¼š"><a href="#ğŸ§ -é‚£è¿™æ®µè¯çš„æ ¸å¿ƒæ„æ€å°±æ˜¯ï¼š" class="headerlink" title="ğŸ§  é‚£è¿™æ®µè¯çš„æ ¸å¿ƒæ„æ€å°±æ˜¯ï¼š"></a>ğŸ§  é‚£è¿™æ®µè¯çš„æ ¸å¿ƒæ„æ€å°±æ˜¯ï¼š</h2><blockquote>
<p><strong>ä½ è‡ªå·±ä¸ç”¨ new ä¸€ä¸ª MainActivityï¼Œç³»ç»Ÿå·²ç»å¸®ä½ åˆ›å»ºå¥½äº†ï¼</strong></p>
</blockquote>
<p>æ‰€ä»¥ä¸å…¶è‡ªå·±åˆ›å»ºä¸€ä¸ªå¯èƒ½ä¸å®Œæ•´çš„å®ä¾‹ï¼ˆä¼šæœ‰å¾ˆå¤šé—®é¢˜ï¼‰ï¼Œ<strong>ä¸å¦‚ç›´æ¥å»â€œæ‹¿åˆ°â€ç³»ç»Ÿå·²ç»åˆ›å»ºçš„é‚£ä¸ªå®ä¾‹ï¼Œç„¶åè°ƒç”¨ä½ æƒ³è¦çš„å‡½æ•°ï¼Œæ¯”å¦‚</strong> <strong>â€‹<code>flag()</code>â€‹</strong> â€‹ <strong>ã€‚</strong></p>
<h2 id="âœ…-æ€»ç»“ä¸€ä¸‹ï¼Œé€šä¿—ç‚¹è¯´å°±æ˜¯ï¼š"><a href="#âœ…-æ€»ç»“ä¸€ä¸‹ï¼Œé€šä¿—ç‚¹è¯´å°±æ˜¯ï¼š" class="headerlink" title="âœ… æ€»ç»“ä¸€ä¸‹ï¼Œé€šä¿—ç‚¹è¯´å°±æ˜¯ï¼š"></a>âœ… æ€»ç»“ä¸€ä¸‹ï¼Œé€šä¿—ç‚¹è¯´å°±æ˜¯ï¼š</h2><blockquote>
<p>â€œAndroid ç³»ç»Ÿä¼šè‡ªåŠ¨å¸®ä½ åˆ›å»º MainActivity çš„å®ä¾‹ï¼Œæ‰€ä»¥ä½ <strong>ä¸éœ€è¦è‡ªå·±é€ ä¸€ä¸ª</strong>ã€‚ç”¨ Frida å¯ä»¥ç›´æ¥æ‰¾åˆ°è¿™ä¸ªå·²ç»å­˜åœ¨çš„å®ä¾‹ï¼Œ<strong>ç„¶åè°ƒç”¨ä½ æƒ³è¦çš„æ–¹æ³•ï¼ˆæ¯”å¦‚</strong> <strong>â€‹<code>flag()</code>â€‹</strong> â€‹ <strong>ï¼‰æ¥æ‹¿ flagã€‚â€</strong></p>
</blockquote>
</blockquote>
<p>æœ‰è¿™æ ·ä¸€ä¸ªæ¨¡æ¿</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">performNow</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&#x27;&lt;åŒ…å&gt;.&lt;ç±»å&gt;&#x27;</span>, &#123;<br>    <span class="hljs-attr">onMatch</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">instance</span>) &#123;<br>      <span class="hljs-comment">// å¾…åŠäº‹é¡¹</span><br>    &#125;,<br>    <span class="hljs-attr">onComplete</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;&#125;<br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p><strong>onMatch</strong></p>
<ul>
<li>â€‹<code>onMatch</code>å›è°ƒå‡½æ•°åœ¨<code>Java.choose</code>æ“ä½œæœŸé—´æ‰¾åˆ°æŒ‡å®šç±»çš„æ¯ä¸ªå®ä¾‹æ—¶æ‰§è¡Œã€‚</li>
<li>è¿™ä¸ªå›è°ƒå‡½æ•°æ¥æ”¶å½“å‰å®ä¾‹ä½œä¸ºå®ƒçš„å‚æ•°ã€‚</li>
<li>æ‚¨å¯ä»¥åœ¨<code>onMatch</code>å›è°ƒä¸­å®šä¹‰è‡ªå®šä¹‰æ“ä½œï¼Œä»¥åœ¨æ¯ä¸ªå®ä¾‹ä¸Šæ‰§è¡Œã€‚</li>
<li>â€‹<code>function(instance) &#123;&#125;</code>ï¼Œ<code>instance</code>å‚æ•°è¡¨ç¤ºç›®æ ‡ç±»çš„æ¯ä¸ªåŒ¹é…å®ä¾‹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•å…¶ä»–åç§°ã€‚å‚æ•° <code>instance</code> å°±æ˜¯è¿™ä¸ª MainActivity çš„å¯¹è±¡ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œè°ƒç”¨å®ƒçš„å‡½æ•°ï¼Œæ¯”å¦‚ <code>instance.flag()</code>â€‹</li>
</ul>
</li>
<li><p><strong>onComplete</strong></p>
<ul>
<li>â€‹<code>onComplete</code>å›è°ƒåœ¨<code>Java.choose</code>æ“ä½œå®Œæˆåæ‰§è¡Œæ“ä½œæˆ–æ¸…ç†ä»»åŠ¡ã€‚æ­¤å—æ˜¯å¯é€‰çš„ï¼Œå¦‚æœæ‚¨åœ¨æœç´¢å®Œæˆåä¸éœ€è¦æ‰§è¡Œä»»ä½•ç‰¹å®šæ“ä½œï¼Œåˆ™å¯ä»¥é€‰æ‹©å°†å…¶ç•™ç©ºã€‚</li>
</ul>
</li>
</ul>
</blockquote>
<p>å°è¯•ä½¿ç”¨è¯¥æ¨¡æ¿å¯»æ‰¾MainActivityå®ä¾‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&#x27;com.ad2001.frida0x5.MainActivity&#x27;</span>, &#123;<br>        <br>        <span class="hljs-attr">onMatch</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">instance</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Sucess found!!!&quot;</span>);<br>        &#125;,<br>        <span class="hljs-attr">onComplete</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;end&quot;</span>);<br>        &#125;<br>    &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413203112.png" alt="image"></p>
<p>åœ¨è¿™é‡Œè¿˜å‘ç°ä¸ªé—®é¢˜ï¼Œå½“ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨fridaæ—¶ï¼Œåªä¼šæ‰“å°ä¸€ä¸ª end ï¼Œhookä¸ä¸Šï¼Œéœ€è¦é‡æ–°ä¿®æ”¹ä¸€ä¸‹è„šæœ¬ï¼ˆä¾‹å¦‚æ³¨é‡Šæ‰æŸä¸€è¡Œå†åŠ ä¸Šï¼‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">frida -U -f com.<span class="hljs-property">ad2001</span>.<span class="hljs-property">frida0x5</span> -l lab05.<span class="hljs-property">js</span><br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413203858.png" alt="image"></p>
<p>åŸå› å…¶å®è·Ÿ 0x2 ä¸€æ ·ï¼Œç”±äºè„šæœ¬æ˜¯ç«‹å³æ³¨å…¥ï¼Œappè¿˜æ¥ä¸åŠåˆ›å»ºMainActivityå®ä¾‹ï¼Œè‡ªç„¶å°±æ²¡æ‰¾åˆ°</p>
<p>è§£å†³åŠæ³•ä¹Ÿè·Ÿ 0x2 ä¸€æ ·ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°</p>
<p>â€</p>
<h2 id="0x6-MainActivityä¸­çš„éé™æ€æ–¹æ³•ä¸”å‚æ•°é€šè¿‡éMainActivityéé™æ€æ–¹æ³•ä¼ é€’"><a href="#0x6-MainActivityä¸­çš„éé™æ€æ–¹æ³•ä¸”å‚æ•°é€šè¿‡éMainActivityéé™æ€æ–¹æ³•ä¼ é€’" class="headerlink" title="0x6 MainActivityä¸­çš„éé™æ€æ–¹æ³•ä¸”å‚æ•°é€šè¿‡éMainActivityéé™æ€æ–¹æ³•ä¼ é€’"></a>0x6 MainActivityä¸­çš„éé™æ€æ–¹æ³•ä¸”å‚æ•°é€šè¿‡éMainActivityéé™æ€æ–¹æ³•ä¼ é€’</h2><p>MainActivityä¸­çš„éé™æ€æ–¹æ³• get_flag ï¼Œå¹¶ä¸”å‚æ•°æ˜¯é€šè¿‡ Checker ç±»å¯¹è±¡ A æ¥ä¼ é€’çš„</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413210156.png" alt="image"></p>
<p>Checkerç±»å¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413210311.png" alt="image"></p>
<p>æ‰€ä»¥è¿™é¢˜å°±æ˜¯0x5 0x4 0x3çš„ç»“åˆï¼Œä½†æ˜¯åœ¨ 0x3 ä¸­ï¼Œå˜é‡ä¸ºé™æ€å˜é‡ï¼Œæ‰€ä»¥éœ€è¦è¿™é‡Œéœ€è¦åˆ›å»ºä¸€ä¸ªç±»çš„å¯¹è±¡æ¥å¯¹å˜é‡è¿›è¡Œæ›´æ”¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413210502.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&quot;com.ad2001.frida0x6.MainActivity&quot;</span>, &#123;<br>        <br>        <span class="hljs-attr">onMatch</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">MainActivity</span>) &#123;<br>            <br>            <span class="hljs-keyword">var</span> c = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x6.Checker&quot;</span>)<br>            <span class="hljs-keyword">var</span> A = c.$new();<br><br>            A.<span class="hljs-property">num1</span>.<span class="hljs-property">value</span> = <span class="hljs-number">1234</span>;<br>            A.<span class="hljs-property">num2</span>.<span class="hljs-property">value</span> = <span class="hljs-number">4321</span>;<br><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;success&quot;</span>);<br>            <span class="hljs-title class_">MainActivity</span>.<span class="hljs-title function_">get_flag</span>(A);<br>        &#125;,<br>        <span class="hljs-attr">onComplete</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;end&quot;</span>);<br>        &#125;<br>    &#125;);<br><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-comment">// setImmediate(main);</span><br><span class="hljs-built_in">setTimeout</span>(main, <span class="hljs-number">1000</span>);<br></code></pre></td></tr></table></figure>

<p>â€</p>
<h2 id="0x7-Hookæ„é€ å‡½æ•°"><a href="#0x7-Hookæ„é€ å‡½æ•°" class="headerlink" title="0x7 Hookæ„é€ å‡½æ•°"></a>0x7 Hookæ„é€ å‡½æ•°</h2><p>æ„é€ å‡½æ•°æ˜¯ Java ç±»ä¸­çš„ä¸€ç§ç‰¹æ®Šæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼š<strong>åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ç”¨æ¥åˆå§‹åŒ–å¯¹è±¡çš„å±æ€§</strong>ã€‚</p>
<p>å…ˆä¸¾ä¸ªä¾‹å­æ¥äº†è§£ä¸€ä¸‹æ£®è«æ˜¯Javaä¸­çš„æ„é€ å‡½æ•°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> &#123;<br>    String name;<br>    <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-comment">// æ„é€ å‡½æ•°</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Dog</span><span class="hljs-params">(String n, <span class="hljs-type">int</span> a)</span> &#123;<br>        name = n;<br>        age = a;<br>    &#125;<br><br>    <span class="hljs-comment">// æ™®é€šæ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">bark</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(name + <span class="hljs-string">&quot; æ±ªæ±ªå«ï¼&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showInfo</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è¿™åªç‹—å« &quot;</span> + name + <span class="hljs-string">&quot;ï¼Œå®ƒ &quot;</span> + age + <span class="hljs-string">&quot; å²äº†ã€‚&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Dog</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">&quot;å°é»‘&quot;</span>, <span class="hljs-number">3</span>);  <span class="hljs-comment">// è°ƒç”¨æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–å¯¹è±¡       Dogï¼ˆç¬¬ä¸€ä¸ªï¼‰ğŸ‘‰ è¡¨ç¤ºå˜é‡ d çš„ ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ç±»åï¼Œè¯´æ˜ d æ˜¯ä¸€ä¸ª Dog ç±»å‹çš„å¯¹è±¡ã€‚</span><br>                                    <span class="hljs-comment">//new Dog(&quot;å°é»‘&quot;, 3)ï¼ˆåé¢è¿™ä¸ªï¼‰ğŸ‘‰ æ˜¯ è°ƒç”¨æ„é€ å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Dog å¯¹è±¡ï¼Œå¹¶ä¼ å…¥ä¸¤ä¸ªå‚æ•°ã€‚</span><br>        d.bark();                   <span class="hljs-comment">// è°ƒç”¨æ™®é€šæ–¹æ³•</span><br>        d.showInfo();               <span class="hljs-comment">// è°ƒç”¨æ™®é€šæ–¹æ³•</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>æ¥çœ‹æœ¬é¢˜ï¼Œè°ƒç”¨äº†flagæ–¹æ³•ï¼Œå¹¶ä¸”é€šè¿‡Checkeræ„é€ å‡½æ•°å¯¹ num1 å’Œ num2 èµ‹å€¼ä¸º 123 å’Œ 321</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413213132.png" alt="image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413213246.png" alt="image"></p>
<p>åœ¨Fridaä¸­ä½¿ç”¨ $init å…³é”®å­—æ¥ hook æ„é€ å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Checker</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x7.Checker&quot;</span>);<br>    <span class="hljs-title class_">Checker</span>.<span class="hljs-property">$init</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) &#123;<br><br>    <span class="hljs-comment">//  Checker.$init æ˜¯è¿™ä¸ªç±»çš„ æ„é€ å‡½æ•°ï¼ˆconstructorï¼‰ã€‚</span><br>    <span class="hljs-comment">//  .implementation = function (a, b) è¡¨ç¤ºä½ è¦â€œåŠ«æŒâ€è¿™ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨ä½ è‡ªå·±çš„å®ç°æ¥æ›¿ä»£åŸæ¥çš„ã€‚</span><br>    <span class="hljs-comment">//  a, b å°±æ˜¯åŸæœ¬ä¼ ç»™æ„é€ å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°ã€‚</span><br><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Origin num&quot;</span>, a, b);<br>        <span class="hljs-variable language_">this</span>.$init(<span class="hljs-number">666</span>, <span class="hljs-number">666</span>);    <span class="hljs-comment">//this.$init(...) è¡¨ç¤ºâ€œç”¨åŸæœ¬çš„æ–¹å¼ç»§ç»­åˆå§‹åŒ–å¯¹è±¡ï¼Œä½†ç”¨æˆ‘ç»™çš„å‚æ•°â€</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;success&quot;</span>);  <br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413215324.png" alt="image"></p>
<p>å†™åˆ°è¿™æˆ‘æœ‰ç‚¹å¥½å¥‡å¦‚æœä½¿ç”¨ 0x1 çš„æ–¹æ³•ç›´æ¥å» hook æ„é€ å‡½æ•°ä¼šæ€æ ·</p>
<p>æ¥å§ï¼Œå®è·µå‡ºçœŸçŸ¥</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Ch</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x7.Checker&quot;</span>);<br>    <span class="hljs-title class_">Ch</span>.<span class="hljs-property">Checker</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;int&#x27;</span>, <span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) &#123; <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Origin num&quot;</span>, a, b); <span class="hljs-comment">//console.logæ‰“å°</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">Checker</span>(<span class="hljs-number">666</span>, <span class="hljs-number">666</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p>å“ˆå“ˆï¼ŒæŠ¥é”™äº†ï¼Œcannot read property â€˜overloadâ€™ of undefined è¯´æ˜è¯•å›¾ hook çš„ Java æ–¹æ³•å¹¶æ²¡æœ‰æ‰¾åˆ°</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413215448.png" alt="image"></p>
<p>ç„¶åæˆ‘åˆå¥½å¥‡ï¼Œå¦‚æœä½¿ç”¨ 0x3 çš„æ–¹æ³•ç›´æ¥æ”¹å˜ num1 å’Œ num2 ä¼šæ€æ ·</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413215954.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Checker</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x7.Checker&quot;</span>);<br>    <span class="hljs-title class_">Checker</span>.<span class="hljs-property">$init</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) &#123;<br><br>    <span class="hljs-comment">//  Checker.$init æ˜¯è¿™ä¸ªç±»çš„ æ„é€ å‡½æ•°ï¼ˆconstructorï¼‰ã€‚</span><br>    <span class="hljs-comment">//  .implementation = function (a, b) è¡¨ç¤ºä½ è¦â€œåŠ«æŒâ€è¿™ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨ä½ è‡ªå·±çš„å®ç°æ¥æ›¿ä»£åŸæ¥çš„ã€‚</span><br>    <span class="hljs-comment">//  a, b å°±æ˜¯åŸæœ¬ä¼ ç»™æ„é€ å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°ã€‚</span><br><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Origin num&quot;</span>, a, b);<br>        <span class="hljs-comment">// this.$init(666, 666);    //this.$init(...) è¡¨ç¤ºâ€œç”¨åŸæœ¬çš„æ–¹å¼ç»§ç»­åˆå§‹åŒ–å¯¹è±¡ï¼Œä½†ç”¨æˆ‘ç»™çš„å‚æ•°â€</span><br>        <span class="hljs-title class_">Checker</span>.<span class="hljs-property">num1</span>.<span class="hljs-property">value</span> = <span class="hljs-number">666</span>;<br>        <span class="hljs-title class_">Checker</span>.<span class="hljs-property">num2</span>.<span class="hljs-property">value</span> = <span class="hljs-number">666</span>;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;success&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p>å“ˆå“ˆï¼Œæœç„¶åˆæŠ¥é”™äº†  Error: Cannot access an instance field without an instance è¡¨ç¤ºè¯•å›¾è®¿é—® <code>Checker.num1</code>ï¼Œä½†è¿™æ˜¯ <strong>å®ä¾‹å­—æ®µï¼ˆæˆå‘˜å˜é‡ï¼‰</strong> ï¼Œä½ å¿…é¡»é€šè¿‡ä¸€ä¸ªå…·ä½“å¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯ <code>this</code>ï¼‰æ¥è®¿é—®å®ƒ</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250413220144.png" alt="image"></p>
<p>æ”¹æˆè¿™æ ·æˆ–è®¸ä¼šæ¯”åˆä»£è„šæœ¬å¥½ç†è§£ä¸€äº›ï¼Œè·Ÿ 0x1 ä¹Ÿæ›´åƒ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Checker</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x7.Checker&quot;</span>);<br>    <span class="hljs-title class_">Checker</span>.<span class="hljs-property">$init</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;int&#x27;</span>, <span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Origin num:&quot;</span>, a, b);<br><br>        <span class="hljs-comment">// è°ƒç”¨åŸå§‹æ„é€ å‡½æ•°åˆå§‹åŒ–å¯¹è±¡</span><br>        <span class="hljs-variable language_">this</span>.$init(a, b);<br><br>        <span class="hljs-comment">// ä¿®æ”¹æˆå‘˜å˜é‡</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">num1</span>.<span class="hljs-property">value</span> = <span class="hljs-number">666</span>;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">num2</span>.<span class="hljs-property">value</span> = <span class="hljs-number">666</span>;<br><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Success: num1 and num2 changed to 666&quot;</span>);<br>    &#125;;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p>â€</p>
<h2 id="0x8-Hook-Nativeå±‚ä¸­è°ƒç”¨çš„å‡½æ•°å¹¶ä¸”è¯»å–ä¼ å…¥çš„å‚æ•°"><a href="#0x8-Hook-Nativeå±‚ä¸­è°ƒç”¨çš„å‡½æ•°å¹¶ä¸”è¯»å–ä¼ å…¥çš„å‚æ•°" class="headerlink" title="0x8 Hook Nativeå±‚ä¸­è°ƒç”¨çš„å‡½æ•°å¹¶ä¸”è¯»å–ä¼ å…¥çš„å‚æ•°"></a>0x8 Hook Nativeå±‚ä¸­è°ƒç”¨çš„å‡½æ•°å¹¶ä¸”è¯»å–ä¼ å…¥çš„å‚æ•°</h2><p>ä»æœ¬ç« å¼€å§‹è¿›å…¥ Nativeå±‚</p>
<p>æ¨¡æ¿å¦‚ä¸‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(targetAddress, &#123;<br>    <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Entering &#x27;</span> + functionName);<br>        <span class="hljs-comment">// Modify or log arguments if needed</span><br>    &#125;,<br>    <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Leaving &#x27;</span> + functionName);<br>        <span class="hljs-comment">// Modify or log return value if needed</span><br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>å®ƒçš„ä½œç”¨æ˜¯ï¼š</p>
<p><strong>å½“ç¨‹åºè¿è¡Œåˆ°æŸä¸ªç‰¹å®šå‡½æ•°ï¼ˆåœ°å€ä¸º</strong> <strong>â€‹<code>targetAddress</code>â€‹</strong>â€‹ <strong>ï¼‰æ—¶ï¼š</strong></p>
<ul>
<li><strong>å‡½æ•°åˆšè¿›å…¥æ—¶ï¼ˆonEnterï¼‰</strong> ï¼šæ‰“å°ä¸€å¥è¯ï¼Œè¯´â€œæˆ‘è¿›æ¥äº†â€ï¼›</li>
<li><strong>å‡½æ•°æ‰§è¡Œå®Œè¿”å›æ—¶ï¼ˆonLeaveï¼‰</strong> ï¼šå†æ‰“å°ä¸€å¥â€œæˆ‘å‡ºå»äº†â€ã€‚</li>
</ul>
<p>æ¯è¡Œçš„æ„æ€</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(targetAddress, &#123;<br></code></pre></td></tr></table></figure>

<p>ç”¨ Frida çš„ <code>Interceptor.attach</code> æ¥<strong>æ‹¦æˆªï¼ˆhookï¼‰æŸä¸ªå‡½æ•°åœ°å€</strong>ã€‚è¿™ä¸ªåœ°å€æ˜¯ä½ æƒ³è§‚å¯Ÿæˆ–ä¿®æ”¹çš„å‡½æ•°ä½ç½®ï¼ˆ<code>targetAddress</code>ï¼‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Entering &#x27;</span> + functionName);<br>    <span class="hljs-comment">// Modify or log arguments if needed</span><br>&#125;,<br></code></pre></td></tr></table></figure>

<p>å½“ç¨‹åºåˆšè¿›å…¥è¿™ä¸ªå‡½æ•°æ—¶ï¼Œä¼šæ‰§è¡Œ <code>onEnter</code> è¿™ä¸ªå›è°ƒã€‚<br>ä½ å¯ä»¥ï¼š</p>
<ul>
<li><p>æ‰“å°æ—¥å¿—ï¼ˆåƒç°åœ¨è¿™æ ·æ‰“å°â€œæ­£åœ¨è¿›å…¥å‡½æ•°â€ï¼‰ï¼›</p>
</li>
<li><p>æŸ¥çœ‹å’Œä¿®æ”¹ä¼ å…¥å‚æ•°ï¼ˆ<code>args</code> æ˜¯å‚æ•°åˆ—è¡¨ï¼‰ã€‚</p>
<p>â€</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Leaving &#x27;</span> + functionName);<br>    <span class="hljs-comment">// Modify or log return value if needed</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>å½“å‡½æ•°æ‰§è¡Œå®Œå‡†å¤‡è¿”å›æ—¶ï¼Œä¼šæ‰§è¡Œ <code>onLeave</code>ã€‚<br>ä½ å¯ä»¥ï¼š</p>
<ul>
<li>æ‰“å°è¿”å›å€¼ï¼›</li>
<li>ä¿®æ”¹è¿”å›å€¼ï¼ˆ<code>retval</code> æ˜¯è¿”å›å€¼ï¼‰ã€‚</li>
</ul>
<p>â€</p>
<p>éœ€è¦è·å–targetAddressæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹API</p>
<ol>
<li>â€‹<code>Module.enumerateExports()</code><br> é€šè¿‡è°ƒç”¨ Module.enumerateExports()ï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°å¯¼å‡ºå‡½æ•°çš„åç§°ã€åœ°å€ä»¥åŠå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯¹äºè¿›è¡Œå‡½æ•°æŒ‚é’©ã€å‡½æ•°è·Ÿè¸ªæˆ–è€…è°ƒç”¨å…¶ä»–å‡½æ•°éƒ½éå¸¸æœ‰ç”¨ã€‚</li>
<li>â€‹<code>Module.getExportByName()</code><br> å½“æˆ‘ä»¬çŸ¥é“è¦æŸ¥æ‰¾çš„å¯¼å‡ºé¡¹çš„åç§°ä½†ä¸çŸ¥é“å…¶åœ°å€æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Module.getExportByName()ã€‚é€šè¿‡æä¾›å¯¼å‡ºé¡¹çš„åç§°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸è¯¥åç§°å¯¹åº”çš„å¯¼å‡ºé¡¹çš„åœ°å€ã€‚</li>
<li>â€‹<code>Module.findExportByName()</code><br> è¿™ä¸ Module.getExportByName() æ˜¯ä¸€æ ·çš„ã€‚å”¯ä¸€çš„åŒºåˆ«åœ¨äºï¼Œå¦‚æœæœªæ‰¾åˆ°å¯¼å‡ºé¡¹ï¼ŒModule.getExportByName() ä¼šå¼•å‘å¼‚å¸¸ï¼Œè€Œ Module.findExportByName() å¦‚æœæœªæ‰¾åˆ°å¯¼å‡ºé¡¹åˆ™è¿”å› <code>null</code>â€‹</li>
<li>â€‹<code>Module.getBaseAddress()</code><br> é€šè¿‡è°ƒç”¨ Module.getBaseAddress() å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è·å–æŒ‡å®šæ¨¡å—çš„åŸºå€åœ°å€ï¼Œç„¶åå¯ä»¥åŸºäºè¿™ä¸ªåŸºå€åœ°å€è¿›è¡Œåç§»è®¡ç®—ï¼Œä»¥å®šä½æ¨¡å—å†…éƒ¨çš„ç‰¹å®šå‡½æ•°ã€å˜é‡æˆ–è€…æ•°æ®ç»“æ„</li>
<li>â€‹<code>Module.enumerateImports()</code><br> é€šè¿‡è°ƒç”¨ Module.enumerateImports() å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°æŒ‡å®šæ¨¡å—å¯¼å…¥çš„å¤–éƒ¨å‡½æ•°æˆ–å˜é‡çš„åç§°ã€åœ°å€ä»¥åŠå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚</li>
</ol>
<p>â€</p>
<p>ä½¿ç”¨ Module.enumerateImports(â€œlibfrida0x8.soâ€) æŸ¥çœ‹å¯¼å…¥è¡¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250414155153.png" alt="image"></p>
<p>ä½¿ç”¨Module.findExportByName(â€œlibc.soâ€,â€strcmpâ€);æ¥è·å–strcmpçš„åœ°å€</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250414155318.png" alt="image"></p>
<p>æ¥çœ‹è¿™é¢˜</p>
<p>åŠ è½½äº†ä¸€ä¸ª frida0x8</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250414174714.png" alt="image"></p>
<p>soæ–‡ä»¶é‡Œæœ‰ä¸€ä¸ª strcmp å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•° s2 å°±æ˜¯ç»è¿‡å¤„ç†åçš„æ­£ç¡®çš„ flag ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠstrcmpå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°hookå‡ºæ¥</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250414174755.png" alt="image"></p>
<p>æˆ‘å…ˆæŒ‰ç…§æˆ‘è‡ªå·±çš„æƒ³æ³•å†™äº†ä¸€ä¸ªè„šæœ¬</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> target = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>, <span class="hljs-string">&quot;strcmp&quot;</span>); <span class="hljs-comment">//æŸ¥æ‰¾strcmpçš„åœ°å€</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;strcmp addr is :&quot;</span>, target.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br><br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(target, &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">1</span>])); <span class="hljs-comment">//æ‰“å°strcmpçš„ç¬¬äºŒä¸ªå‚æ•°</span><br>        &#125;,<br><br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br>            <br>        &#125;<br>    &#125;)<br>&#125;<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p>è¾“å‡ºå¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250414180856.png" alt="image"></p>
<p>è¿™é‡Œå…¶å®æ˜¯å› ä¸ºï¼Œæˆ‘ä»¥ä¸ºæˆ‘hookçš„æ˜¯ç‰¹å®šçš„æŸä¸€ä¸ªstrcmpï¼Œå®é™…ä¸Šè¿™ä¸ª hook æ˜¯ç”Ÿæ•ˆäºæ‰€æœ‰è°ƒç”¨ <code>libc.so!strcmp</code> çš„åœ°æ–¹ï¼Œæ— è®ºæ˜¯ native è°ƒç”¨è¿˜æ˜¯é€šè¿‡ JNI è¢« Java è°ƒç”¨çš„ native æ–¹æ³•ï¼Œ<strong>éƒ½ä¼šè¢«æ‹¦æˆª</strong></p>
<p>æ‰€ä»¥å¯¼è‡´äº†è¿™ç§æƒ…å†µ</p>
<p>æ‰€ä»¥è¦åŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œå½“strcmpçš„ç¬¬ä¸€ä¸ªå‚æ•°åŒ…å«æŸä¸ªæ•°ï¼ˆä¾‹å¦‚666ï¼‰æ—¶ï¼Œå°±æ‰“å°ç¬¬äºŒä¸ªå‚æ•°çš„ç»“æœï¼Œä½¿æˆ‘ä»¬çš„ç›®æ ‡æ›´åŠ â€œç²¾ç¡®â€</p>
<p>ä¿®æ”¹è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> target = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>, <span class="hljs-string">&quot;strcmp&quot;</span>); <span class="hljs-comment">//æŸ¥æ‰¾strcmpçš„åœ°å€</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;strcmp addr is :&quot;</span>, target.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br><br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(target, &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123; <span class="hljs-comment">//argsåªæ˜¯æˆ‘å¯¹å‚æ•°èµ·çš„åå­—ï¼Œå¯ä»¥æ”¹æˆä»»ä½•åˆ«çš„</span><br><br>            <span class="hljs-keyword">var</span> input = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">0</span>]);<br><br>            <span class="hljs-keyword">if</span> (input.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;666&quot;</span>)) &#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">1</span>])); <span class="hljs-comment">//æ‰“å°strcmpçš„ç¬¬äºŒä¸ªå‚æ•°</span><br>            &#125;<br>            <br>        &#125;,<br><br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br>            <br>        &#125;<br>    &#125;)<br>&#125;<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨ Frida ä¸­ï¼š</p>
<ul>
<li><p>â€‹<code>Memory</code> æ˜¯ Frida çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†è®¿é—®ç›®æ ‡è¿›ç¨‹å†…å­˜çš„æ–¹æ³•ã€‚</p>
</li>
<li><p>å®ƒå¯ä»¥ç”¨æ¥ï¼š</p>
<ul>
<li>è¯»å–å†…å­˜ï¼ˆå¦‚ <code>Memory.readUtf8String(ptr)</code>ã€<code>Memory.readByteArray(ptr, size)</code>ï¼‰</li>
<li>å†™å…¥å†…å­˜ï¼ˆå¦‚ <code>Memory.writeUtf8String(ptr, &quot;hello&quot;)</code>ï¼‰</li>
</ul>
</li>
</ul>
<p>ä½ ç”¨çš„ <code>Memory.readUtf8String()</code> æ˜¯å®ƒæœ€å¸¸ç”¨çš„å‡½æ•°ä¹‹ä¸€ï¼Œä¸“é—¨å¤„ç† C å­—ç¬¦ä¸²ï¼ˆä»¥ null ç»“å°¾çš„ UTF-8 å­—ç¬¦ä¸²ï¼‰ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250414181913.png" alt="image"></p>
<p>â€</p>
<h2 id="0x9-Hook-Nativeå±‚å‡½æ•°çš„è¿”å›å€¼"><a href="#0x9-Hook-Nativeå±‚å‡½æ•°çš„è¿”å›å€¼" class="headerlink" title="0x9 Hook Nativeå±‚å‡½æ•°çš„è¿”å›å€¼"></a>0x9 Hook Nativeå±‚å‡½æ•°çš„è¿”å›å€¼</h2><p>check_flagçš„å€¼å¦‚æœæ˜¯1337å°±æ‰“å°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250414190811.png" alt="image"></p>
<p>nativeå±‚ä¸­çš„è¯¥å‡½æ•°çš„è¿”å›å€¼æ˜¯1</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250414190831.png" alt="image"></p>
<p>ä¿®æ”¹è¯¥å‡½æ•°çš„è¿”å›å€¼å³å¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> target = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateExports</span>(<span class="hljs-string">&quot;liba0x9.so&quot;</span>)[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;address&quot;</span>];<br><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;addr is :&quot;</span>, target);<br><br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(target, &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;    <br>        &#125;,<br><br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Origin retval is :&quot;</span>, retval);<br>            retval.<span class="hljs-title function_">replace</span>(<span class="hljs-number">1337</span>);<br>        &#125;<br>    &#125;)<br>&#125;<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure>

<p>æ€è€ƒï¼š</p>
<p>è¿™ä¸€å¥</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> target = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateExports</span>(<span class="hljs-string">&quot;liba0x9.so&quot;</span>)[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;address&quot;</span>];<br></code></pre></td></tr></table></figure>

<p>åœ¨ 0x8 ä¸­ä½¿ç”¨çš„æ˜¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> target = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>, <span class="hljs-string">&quot;strcmp&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>æˆ‘çš„çŒœæƒ³æ˜¯ï¼Œåœ¨ 0x8 ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨</p>
<p>Module.enumerateImports(â€œlibfrida0x8.soâ€)æŸ¥çœ‹å¯¼å…¥è¡¨ï¼Œè€Œåœ¨è¯¥é¢˜ç›®ä¸­ï¼Œç”±äºhookçš„æ˜¯è‡ªå·±çš„å‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨Module.enumerateExports(â€œliba0x9.soâ€)æŸ¥çœ‹å¯¼å‡ºè¡¨</p>
<blockquote>
<ul>
<li><strong>å¯¼å…¥è¡¨ï¼ˆImportsï¼‰</strong> ï¼š<br>æ˜¯è¿™ä¸ªåº“ <strong>è°ƒç”¨åˆ«äººçš„å‡½æ•°</strong>ï¼Œé€šå¸¸æ˜¯ç³»ç»Ÿå‡½æ•°ï¼Œæ¯”å¦‚ <code>libc.so</code> é‡Œçš„ <code>malloc</code>ã€<code>printf</code>ã€<code>strlen</code> ç­‰ã€‚</li>
<li><strong>å¯¼å‡ºè¡¨ï¼ˆExportsï¼‰</strong> ï¼š<br>æ˜¯è¿™ä¸ªåº“ <strong>æš´éœ²ç»™åˆ«äººç”¨çš„å‡½æ•°</strong>ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯ä½ è‡ªå·±å†™çš„ï¼Œæ¯”å¦‚ <code>Java_com_example_myapp_NativeMethod</code> è¿™ç§ native æ¥å£ï¼Œæˆ–è€…ä¸€äº›æ’ä»¶è°ƒç”¨çš„å…¥å£å‡½æ•°ã€‚</li>
</ul>
</blockquote>
<p>æŸ¥çœ‹å¯¼å‡ºè¡¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250414191954.png" alt="image"></p>
<p>å°è¯•æ”¹æˆè·Ÿ 0x8 ä¸­å·®ä¸å¤šçš„å†™æ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> target = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;liba0x9.so&quot;</span>, <span class="hljs-string">&quot;Java_com_ad2001_a0x9_MainActivity_check_1flag&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>å¥½å§è¿™æ ·ä¹Ÿå¯ä»¥ï¼Œå®è·µå‡ºçœŸçŸ¥äº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250414192036.png" alt="image"></p>
<p>è¿˜æ˜¯è§£é‡Šä¸€ä¸‹è¿™ä¸€å¥å§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> target = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateExports</span>(<span class="hljs-string">&quot;liba0x9.so&quot;</span>)[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;address&quot;</span>];<br></code></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p>â€‹<code>Module.enumerateExports(&quot;liba0x9.so&quot;)</code><br>è¿™ä¼šåˆ—å‡º <code>liba0x9.so</code> è¿™ä¸ª native åº“é‡Œå¯¼å‡ºçš„æ‰€æœ‰å‡½æ•°ï¼ˆä¹Ÿå°±æ˜¯é‚£äº›å¯¹å¤–å¼€æ”¾å¯ä»¥è°ƒç”¨çš„å‡½æ•°ï¼‰ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«ä¿¡æ¯çš„æ•°ç»„ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<span class="hljs-attr">name</span>: <span class="hljs-string">&quot;check_flag&quot;</span>, <span class="hljs-attr">address</span>: <span class="hljs-title function_">ptr</span>(<span class="hljs-string">&quot;0x12345678&quot;</span>), <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;function&quot;</span>&#125;,<br>  &#123;<span class="hljs-attr">name</span>: <span class="hljs-string">&quot;init&quot;</span>, <span class="hljs-attr">address</span>: <span class="hljs-title function_">ptr</span>(<span class="hljs-string">&quot;0x12345690&quot;</span>), <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;function&quot;</span>&#125;,<br>  ...<br>]<br></code></pre></td></tr></table></figure></li>
<li><p>â€‹<code>[0][&quot;address&quot;]</code><br>è¡¨ç¤ºå–è¿™ä¸ªå¯¼å‡ºå‡½æ•°åˆ—è¡¨é‡Œçš„<strong>ç¬¬ä¸€ä¸ªå‡½æ•°çš„åœ°å€</strong>ï¼Œä¹Ÿå°±æ˜¯ <code>check_flag</code> çš„åœ°å€ï¼ˆå‡è®¾ç¬¬ä¸€ä¸ªåˆšå¥½æ˜¯å®ƒï¼‰ã€‚è¿™ä¸€è¡ŒæŠŠè¿™ä¸ªåœ°å€èµ‹å€¼ç»™ <code>check_flag</code> å˜é‡ã€‚[0]è¡¨ç¤ºç´¢å¼•</p>
</li>
</ul>
</blockquote>
<p>â€</p>
<h2 id="0xA-Hook-Nativeå±‚æœªè¢«è°ƒç”¨çš„æ–¹æ³•"><a href="#0xA-Hook-Nativeå±‚æœªè¢«è°ƒç”¨çš„æ–¹æ³•" class="headerlink" title="0xA Hook Nativeå±‚æœªè¢«è°ƒç”¨çš„æ–¹æ³•"></a>0xA Hook Nativeå±‚æœªè¢«è°ƒç”¨çš„æ–¹æ³•</h2><p>ä»æœ¬ç« å¼€å§‹ä½¿ç”¨æ¨¡æ‹Ÿå™¨ä¼šé—ªé€€ï¼Œè¿™é‡Œä½¿ç”¨çš„ç¯å¢ƒæ˜¯Redmi K60 å®‰å“14 å·²ROOT</p>
<p>å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ¨¡æ¿</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> native_adr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativePointer</span>(&lt;address_of_the_native_function&gt;);<br><span class="hljs-keyword">const</span> native_function = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(native_adr, <span class="hljs-string">&#x27;&lt;return type&gt;&#x27;</span>, [<span class="hljs-string">&#x27;argument_data_type&#x27;</span>]);<br><span class="hljs-title function_">native_function</span>(&lt;<span class="hljs-variable language_">arguments</span>&gt;);<br></code></pre></td></tr></table></figure>

<p>â€</p>
<p>è®©æˆ‘ä»¬æ¥é€è¡Œè§£é‡Šä¸€ä¸‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> native_adr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativePointer</span>(&lt;address_of_the_native_function&gt;);<br></code></pre></td></tr></table></figure>

<p>è¿™ä¸€å¥çš„æ„æ€æ˜¯ï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªåŸç”Ÿå‡½æ•°åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼ˆæ¯”å¦‚ 0x12345678ï¼‰ï¼ŒæŠŠå®ƒå°è£…æˆä¸€ä¸ª <code>NativePointer</code> ç±»å‹çš„å¯¹è±¡ï¼Œå¥½è®© Frida èƒ½è¯†åˆ«è¿™ä¸ªåœ°å€ã€‚<code>&lt;address_of_the_native_function&gt;</code> æ˜¯æ‰‹åŠ¨å¡«è¿›å»çš„åœ°å€ï¼Œé€šå¸¸æ˜¯é€šè¿‡é€†å‘åˆ†æï¼ˆIDAã€Frida hook ç­‰ï¼‰æ‰¾åˆ°çš„å‡½æ•°åœ°å€ã€‚</p>
<p>â€</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> native_function = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(native_adr, <span class="hljs-string">&#x27;&lt;return type&gt;&#x27;</span>, [<span class="hljs-string">&#x27;argument_data_type&#x27;</span>]);<br></code></pre></td></tr></table></figure>

<p>è¿™ä¸€è¡Œçš„æ„æ€æ˜¯ï¼ŒæŠŠè¿™ä¸ªåœ°å€ï¼ˆnative_adrï¼‰å¯¹åº”çš„å‡½æ•°è½¬æ¢æˆ JavaScript èƒ½è°ƒç”¨çš„å‡½æ•°ã€‚</p>
<ul>
<li>â€‹<code>&lt;return type&gt;</code> è¡¨ç¤ºè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼ç±»å‹ï¼Œæ¯”å¦‚ <code>&#39;int&#39;</code>ã€<code>&#39;void&#39;</code>ã€<code>&#39;pointer&#39;</code> ç­‰ã€‚</li>
<li>â€‹<code>[&#39;argument_data_type&#39;]</code> è¡¨ç¤ºè¿™ä¸ªå‡½æ•°çš„å‚æ•°ç±»å‹åˆ—è¡¨ï¼Œæ¯”å¦‚ <code>[&#39;int&#39;, &#39;pointer&#39;]</code>ã€‚</li>
</ul>
<p>æ‰€ä»¥è¿™ä¸€è¡Œçš„ä½œç”¨æ˜¯ï¼š<strong>ç”¨ Frida çš„</strong> <strong>â€‹<code>NativeFunction</code>â€‹</strong> <strong>åŒ…è£…åŸç”Ÿå‡½æ•°ï¼Œè®©ä½ å¯ä»¥åƒæ™®é€š JS å‡½æ•°é‚£æ ·å»è°ƒç”¨å®ƒã€‚</strong></p>
<p>â€</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">native_function</span>(&lt;<span class="hljs-variable language_">arguments</span>&gt;);<br></code></pre></td></tr></table></figure>

<p>æœ€åç›´æ¥è°ƒç”¨è¿™ä¸ªåŸç”Ÿå‡½æ•°ï¼Œä¼ å…¥ä½ éœ€è¦çš„å‚æ•°ï¼ˆè¿™äº›å‚æ•°è¦å’Œä¸Šé¢å£°æ˜çš„å‚æ•°ç±»å‹åŒ¹é…ï¼‰</p>
<p>ç°åœ¨æ¥çœ‹çœ‹ä¾‹é¢˜</p>
<p>Javaå±‚å¹¶ä¸èƒ½çœ‹åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ï¼Œåªæ˜¯åŠ è½½äº†<code>stringFromJNI()</code>â€‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415201736.png" alt="image"></p>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹nativeå±‚ï¼ŒstringFromJNIä¹Ÿæ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªget_flagå‡½æ•°å¯ä»¥æ‰“å°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415201824.png" alt="image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415201847.png" alt="image"></p>
<p>äºæ˜¯æ€è·¯å°±æ˜¯ï¼Œåˆ©ç”¨ä¸Šé¢çš„æ¨¡æ¿ hook å‡ºget_flagå‡½æ•°</p>
<p>æ¨¡ä»¿ 0x9 ä¸­ä½¿ç”¨ Module.enumerateExports(â€œlibfrida0xa.soâ€) æŸ¥çœ‹å¯¼å‡ºè¡¨ï¼Œå‘ç°å¯¼å‡ºè¡¨éå¸¸ä¹‹é•¿ï¼Œç›´æ¥ä½¿ç”¨var target &#x3D; Module.enumerateExports(â€œliba0x9.soâ€)[0][â€œaddressâ€];è¿›è¡Œç´¢å¼•ä¼šæœ‰ç‚¹éº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¢ä¸€ç§æ–¹æ³•</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415203957.png" alt="image"></p>
<p>ç”±äºALSRï¼ˆåœ°å€éšæœºåŒ–ï¼‰çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆä½¿ç”¨<code>Module.findBaseAddress(&quot;libfrida0xa.so&quot;);</code>æŸ¥çœ‹ä¸€ä¸‹åŸºåœ°å€</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415203452.png" alt="image"></p>
<p>å¯ä»¥æ„é€ å¦‚ä¸‹å¾ªç¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> base_addr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libfrida0xa.so&quot;</span>);<br> 	<span class="hljs-keyword">var</span> <span class="hljs-built_in">exports</span> = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateExports</span>(<span class="hljs-string">&quot;libfrida0xa.so&quot;</span>);<br><br>   <span class="hljs-keyword">var</span> target = <span class="hljs-literal">null</span>;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; <span class="hljs-built_in">exports</span>[i] != <span class="hljs-literal">null</span>; i++)&#123;<br>       <br>       <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;name&quot;</span>] == <span class="hljs-string">&quot;_Z8get_flagii&quot;</span>) &#123;<br><br>           <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;function get_flag : &quot;</span>, <span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;address&quot;</span>]);<br>           <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>((<span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;address&quot;</span>] - base_addr).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br><br>           target = <span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;address&quot;</span>];<br><br>       &#125;<br><br>   &#125;<br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘ä»¬æ‰¾åˆ°åŸºåœ°å€åï¼Œéå†å¯¼å‡ºè¡¨ï¼Œå¦‚æœåœ¨å¯¼å‡ºè¡¨ä¸­æ‰¾åˆ°äº† get_flag å‡½æ•°ï¼Œå°±æ‰“å°å‡º get_flag å‡½æ•°çš„ç»å¯¹åœ°å€</p>
<p>åŒæ—¶ç”±äºæˆ‘ä»¬çŸ¥é“äº†ç»å¯¹åœ°å€å’ŒåŸºåœ°å€ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é¡ºä¾¿æŠŠåç§»åœ°å€ä¹Ÿæ‰“å°å‡ºæ¥</p>
<p>åç§» &#x3D; å‡½æ•°åœ°å€ - æ¨¡å—åŸºåœ°å€</p>
<p>è¿™æ ·æˆ‘ä»¬å°±æ‰¾åˆ°äº†æˆ‘ä»¬éœ€è¦ hook çš„ç›®æ ‡å‡½æ•°çš„åœ°å€</p>
<p>â€</p>
<p>è¿™é‡Œè¿˜æœ‰ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆ get_flag è¦å†™æˆ â€œ_Z8get_flagiiâ€ å‘¢</p>
<p>è¿™å…¶å®æ˜¯C++ çš„ <strong>name manglingï¼ˆåå­—æ”¹ç¼– &#x2F; åå­—é‡æ•´ï¼‰é—®é¢˜</strong></p>
<p>ä»€ä¹ˆæ˜¯ Name Manglingï¼Ÿ</p>
<p>åœ¨ <strong>C++ ä¸­</strong>ï¼Œå‡½æ•°åä¼šè¢«ç¼–è¯‘å™¨<strong>è‡ªåŠ¨æ”¹å†™</strong>æˆä¸€ä¸²å¸¦æœ‰é¢å¤–ä¿¡æ¯çš„åå­—ï¼Œç§°ä¸º <strong>mangled nameï¼ˆé‡æ•´åå­—ï¼‰</strong> ã€‚</p>
<p>è¿™æ˜¯å› ä¸º <strong>C++ æ”¯æŒå‡½æ•°é‡è½½ï¼ˆåŒåå‡½æ•°ï¼Œä¸åŒå‚æ•°ï¼‰</strong> ï¼Œè€Œæ±‡ç¼–è¯­è¨€ã€é“¾æ¥å™¨ã€æ“ä½œç³»ç»Ÿç­‰åº•å±‚ä¸œè¥¿å¹¶ä¸æ”¯æŒè¿™ä¸€ç‰¹æ€§ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>;<br><span class="hljs-function"><span class="hljs-type">float</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">float</span> a, <span class="hljs-type">float</span> b)</span></span>;<br></code></pre></td></tr></table></figure>

<p>è¿™ä¸¤ä¸ªå‡½æ•°åœ¨ C++ ä¸­æ˜¯åˆæ³•çš„ï¼Œå› ä¸ºå®ƒä»¬å‚æ•°ä¸åŒã€‚ä½†å¦‚æœä½ ä¸åš name manglingï¼Œå®ƒä»¬åœ¨æ±‡ç¼–&#x2F;ç¬¦å·è¡¨é‡Œéƒ½å« <code>add</code>ï¼Œç³»ç»Ÿå°±ä¸çŸ¥é“ä½ åˆ°åº•æƒ³è°ƒç”¨å“ªä¸ªã€‚</p>
<p>æ‰€ä»¥ç¼–è¯‘å™¨ä¼šæŠŠå®ƒä»¬æ”¹åï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-type">int</span> <span class="hljs-keyword">add</span>(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>)       <span class="hljs-comment">--&gt; _Z3addii</span><br><span class="hljs-type">float</span> <span class="hljs-keyword">add</span>(<span class="hljs-type">float</span>, <span class="hljs-type">float</span>) <span class="hljs-comment">--&gt; _Z3addff</span><br></code></pre></td></tr></table></figure>

<p>è¿™å°±æ˜¯ name manglingã€‚</p>
<p>ç”±äºæˆ‘ä»¬ä¸»è¦ç ”ç©¶frida hookï¼Œè¿™ä¸ªé—®é¢˜å°±ä¸è¿‡å¤šèµ˜è¿°</p>
<p>â€</p>
<p>å›å½’æ­£é¢˜ï¼ŒçŸ¥é“äº†æˆ‘ä»¬çš„ç›®æ ‡åœ°å€åå°±å¯ä»¥ç›´æ¥å†™è„šæœ¬å•¦ï¼Œåˆ©ç”¨ä¸Šé¢çš„æ¨¡æ¿</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> base_addr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libfrida0xa.so&quot;</span>);<br>    <span class="hljs-keyword">var</span> <span class="hljs-built_in">exports</span> = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateExports</span>(<span class="hljs-string">&quot;libfrida0xa.so&quot;</span>);<br><br>    <span class="hljs-keyword">var</span> target = <span class="hljs-literal">null</span>;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; <span class="hljs-built_in">exports</span>[i] != <span class="hljs-literal">null</span>; i++)&#123;<br>        <br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;name&quot;</span>] == <span class="hljs-string">&quot;_Z8get_flagii&quot;</span>) &#123;<br><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;function get_flag : &quot;</span>, <span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;address&quot;</span>]);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;base addr is:&quot;</span>, (<span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;address&quot;</span>] - base_addr).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br><br>            target = <span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;address&quot;</span>];<br><br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-keyword">var</span> get_flag_ptr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativePointer</span>(target);<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">My</span>_get_flag = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(get_flag_ptr, <span class="hljs-string">&#x27;char&#x27;</span>, [<span class="hljs-string">&#x27;int&#x27;</span>, <span class="hljs-string">&#x27;int&#x27;</span>]);<br><br><br>    <span class="hljs-keyword">var</span> flag = <span class="hljs-title class_">My</span>_get_flag(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(flag);<br><br><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main)<br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415211743.png" alt="image"></p>
<p>ç”±äºæ‰“å°å‡ºçš„æ˜¯å‡½æ•°çš„è¿”å›å€¼ï¼Œè€Œä¸”soæ–‡ä»¶ä¸­ä½¿ç”¨çš„å‡½æ•°æ˜¯__android_log_printï¼Œæ‰€ä»¥flagåœ¨logcatä¸­å¯ä»¥çœ‹åˆ°</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415211847.png" alt="image"></p>
<p>æ€è€ƒï¼šèƒ½å¦ç›´æ¥åœ¨fridaé¢æ¿ä¸­æ‰“å°å‡ºflagï¼Ÿ</p>
<p>æœ‰çš„å…„å¼Ÿï¼Œæœ‰çš„</p>
<p>è¿˜è®°å¾—lab0x8çš„å†…å®¹å—ï¼Œæˆ‘ä»¬å¯ä»¥Hook <code>__android_log_print</code>è¿™ä¸ªå‡½æ•°ï¼Œç›´æ¥æˆªè· flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415212343.png" alt="image"></p>
<p>flagçš„å†…å®¹æ˜¯<code>__android_log_print</code>çš„ç¬¬å››ä¸ªå‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¯»å–å®ƒçš„ç¬¬å››ä¸ªå‚æ•°ç„¶åæ‰“å°å‡ºæ¥å°±è¡Œ</p>
<p>å®Œæ•´hookå¹¶æ‰“å°flagçš„è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> base_addr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libfrida0xa.so&quot;</span>);<br>    <span class="hljs-keyword">var</span> <span class="hljs-built_in">exports</span> = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateExports</span>(<span class="hljs-string">&quot;libfrida0xa.so&quot;</span>);<br><br>    <span class="hljs-keyword">var</span> target = <span class="hljs-literal">null</span>;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; <span class="hljs-built_in">exports</span>[i] != <span class="hljs-literal">null</span>; i++)&#123;<br>        <br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;name&quot;</span>] == <span class="hljs-string">&quot;_Z8get_flagii&quot;</span>) &#123;<br><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;function get_flag : &quot;</span>, <span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;address&quot;</span>]);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;base addr is:&quot;</span>, (<span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;address&quot;</span>] - base_addr).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br><br>            target = <span class="hljs-built_in">exports</span>[i][<span class="hljs-string">&quot;address&quot;</span>];<br><br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-keyword">var</span> get_flag_ptr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativePointer</span>(target);<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">My</span>_get_flag = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(get_flag_ptr, <span class="hljs-string">&#x27;char&#x27;</span>, [<span class="hljs-string">&#x27;int&#x27;</span>, <span class="hljs-string">&#x27;int&#x27;</span>]);<br><br>    <span class="hljs-keyword">var</span> print_addr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">&quot;__android_log_print&quot;</span>); <span class="hljs-comment">//hook __android_log_printå‡½æ•°</span><br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(print_addr, &#123;<br>        <br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>            <br>            <span class="hljs-keyword">var</span> flagPtr = args[<span class="hljs-number">3</span>];<br>            <span class="hljs-keyword">var</span> flag = flagPtr.<span class="hljs-title function_">readCString</span>();<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(flag); <span class="hljs-comment">//è¯»å–å¹¶æ‰“å°flagå†…å®¹</span><br>        &#125;,<br><br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br>            <br>        &#125;<br>    &#125;);<br><br>    <span class="hljs-keyword">var</span> flag = <span class="hljs-title class_">My</span>_get_flag(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(flag);<br><br><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main)<br></code></pre></td></tr></table></figure>

<p>â€</p>
<h2 id="0xB-æ›´æ”¹Nativeå±‚çš„æ±‡ç¼–æŒ‡ä»¤"><a href="#0xB-æ›´æ”¹Nativeå±‚çš„æ±‡ç¼–æŒ‡ä»¤" class="headerlink" title="0xB æ›´æ”¹Nativeå±‚çš„æ±‡ç¼–æŒ‡ä»¤"></a>0xB æ›´æ”¹Nativeå±‚çš„æ±‡ç¼–æŒ‡ä»¤</h2><p>å…ˆæ¥çœ‹x86ä¸‹çš„æ¨¡æ¿</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> writer = <span class="hljs-keyword">new</span> <span class="hljs-title function_">X86Writer</span>(opcodeaddr);<br><span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">protect</span>(opcodeaddr, <span class="hljs-number">0x1000</span>, <span class="hljs-string">&quot;rwx&quot;</span>);<br><span class="hljs-keyword">try</span> &#123;<br> <br>  writer.<span class="hljs-title function_">flush</span>();<br> <br>&#125; <span class="hljs-keyword">finally</span> &#123;<br> <br>  writer.<span class="hljs-title function_">dispose</span>();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> writer = <span class="hljs-keyword">new</span> <span class="hljs-title function_">X86Writer</span>(opcodeaddr);<br></code></pre></td></tr></table></figure>

<ul>
<li>åˆ›å»ºäº†ä¸€ä¸ªå†™æŒ‡ä»¤çš„â€œå†™æ‰‹â€å¯¹è±¡ï¼Œå« <code>writer</code>ã€‚</li>
<li>â€‹<code>X86Writer</code> æ˜¯ Frida æä¾›çš„ä¸€ä¸ªç±»ï¼Œç”¨æ¥å‘æŒ‡å®šå†…å­˜åœ°å€å†™å…¥ x86 æ±‡ç¼–æŒ‡ä»¤ã€‚</li>
<li>â€‹<code>opcodeaddr</code> æ˜¯ä½ æƒ³ä¿®æ”¹çš„åœ°å€ï¼Œæ¯”å¦‚æŸä¸ªå‡½æ•°å¼€å¤´æˆ–è€…ä¸­é—´çš„æŒ‡ä»¤åœ°å€ã€‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">emory.<span class="hljs-title function_">protect</span>(opcodeaddr, <span class="hljs-number">0x1000</span>, <span class="hljs-string">&quot;rwx&quot;</span>);<br></code></pre></td></tr></table></figure>

<ul>
<li>æŠŠä» <code>opcodeaddr</code> å¼€å§‹çš„ä¸€æ®µå†…å­˜ï¼ˆå¤§å°ä¸º <code>0x1000</code> å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯ä¸€é¡µï¼‰è®¾ç½®ä¸ºå¯è¯»ï¼ˆrï¼‰ã€å¯å†™ï¼ˆwï¼‰ã€å¯æ‰§è¡Œï¼ˆxï¼‰ã€‚</li>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œç¨‹åºçš„ä»£ç åŒºåŸŸä¸€èˆ¬æ˜¯åªè¯»çš„ï¼›è¦æƒ³ä¿®æ”¹å®ƒï¼Œå°±å¾—å…ˆæŠŠå®ƒâ€œè§£é”â€ã€‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">try</span> &#123; writer.<span class="hljs-title function_">flush</span>(); &#125;<br></code></pre></td></tr></table></figure>

<p>tryå—ä¸­æˆ‘ä»¬å¯ä»¥æ’å…¥è¦ä¿®æ”¹&#x2F;æ·»åŠ çš„x86æŒ‡ä»¤ã€‚X86Writerå®ä¾‹æä¾›äº†å„ç§æ–¹æ³•æ¥æ’å…¥å„ç§x86æŒ‡ä»¤ã€‚</p>
<p>â€‹<code>writer.flush();</code>â€‹</p>
<ul>
<li>æ’å…¥æŒ‡ä»¤åï¼Œè°ƒç”¨<code>flush</code>æ–¹æ³•å°†æ›´æ”¹åº”ç”¨åˆ°å†…å­˜ä¸­ã€‚è¿™ç¡®ä¿ä¿®æ”¹åçš„æŒ‡ä»¤è¢«å†™å…¥å†…å­˜ä½ç½®ã€‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">finally</span> &#123; writer.<span class="hljs-title function_">dispose</span>(); &#125;<br></code></pre></td></tr></table></figure>

<p>æœ€åæ— è®ºæ˜¯å¦å‡ºé”™ï¼Œéƒ½è°ƒç”¨ <code>dispose()</code> æ¥é‡Šæ”¾èµ„æºã€‚å¦åˆ™å¯èƒ½ä¼šé€ æˆå†…å­˜æ³„æ¼</p>
<p>å¯¹äºx86è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥é˜…å¦‚ä¸‹æ–‡æ¡£</p>
<p><a target="_blank" rel="noopener" href="https://frida.re/docs/javascript-api/#x86writer">JavaScript API | Frida â€¢ A world-class dynamic instrumentation toolkit</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415215645.png" alt="image"></p>
<p>å¯¹äºarm64è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥é˜…å¦‚ä¸‹æ–‡æ¡£</p>
<p><a target="_blank" rel="noopener" href="https://frida.re/docs/javascript-api/#arm64writer">JavaScript API | Frida â€¢ A world-class dynamic instrumentation toolkit</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415215657.png" alt="image"></p>
<p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹ä¾‹é¢˜ï¼Œä½¿ç”¨çš„æ¶æ„ä¸ºarm64æ¶æ„</p>
<p>Javaå±‚ä¾æ—§æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415215808.png" alt="image"></p>
<p>nativeå±‚ä¸­çš„MainActivityä¼ªä»£ç ç•Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå¾ˆæ˜æ˜¾è¿™ä¸æ­£å¸¸</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415215843.png" alt="image"></p>
<p>çœ‹çœ‹æ§åˆ¶æµï¼Œå‘ç°è¿™é‡Œæ„æˆäº†ä¸€ä¸ªæ°¸å‡è·³è½¬æŒ‡ä»¤ï¼Œå¯¼è‡´æˆ‘ä»¬çš„IDAåç¼–è¯‘å‡ºé”™</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415215932.png" alt="image"></p>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬ç›´æ¥nopæ‰è¿™ä¸ªB.NEå³å¯</p>
<p>IDAæŸ¥çœ‹åç§»åœ°å€æ˜¯åœ¨0x15248å¤„</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415220023.png" alt="image"></p>
<p>å¼€å§‹hook</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> base_addr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getBaseAddress</span>(<span class="hljs-string">&quot;libfrida0xb.so&quot;</span>);<br><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Base address : &quot;</span>, base_addr);<br>    <span class="hljs-keyword">var</span> BNE_addr = base_addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x15248</span>);<br><br>    <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">protect</span>(base_addr, <span class="hljs-number">0x1000</span>, <span class="hljs-string">&quot;rwx&quot;</span>);<br><br>    <span class="hljs-keyword">var</span> writer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Arm64Writer</span>(BNE_addr);<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        writer.<span class="hljs-title function_">putNop</span>();<br>        writer.<span class="hljs-title function_">flush</span>();<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Success!!&quot;</span>);<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        writer.<span class="hljs-title function_">dispose</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-built_in">setTimeout</span>(main, <span class="hljs-number">1000</span>);<br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415220406.png" alt="image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415220417.png" alt="image"></p>
<p>åŒæ ·æ˜¯éœ€è¦åˆ°logcatä¸­æŸ¥çœ‹flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/F10ower/img@main/img/20250415220448.png" alt="image"></p>
<p>â€</p>
<p>â€</p>
<p>â€</p>
<p>â€</p>
<p>â€</p>
<p>â€</p>
<p>â€</p>
<p>â€</p>
<p>â€</p>
<p>â€</p>
<p>â€</p>
<p>â€</p>

      </div>
    </div>
    
      <script src='https://unpkg.com/mermaid@latest/dist/mermaid.min.js'></script>
      <script>
        if (window.mermaid) {
          mermaid.initialize({"startOnload":true});
        }
      </script>
    
  </article>
  <div class="post__foot">
    
    <div class="post-nav">
  
    <a class="post-nav-item-left" href="/2024/07/25/%E4%B8%B4%E6%B1%9F%E4%BB%99/">
      <div class="text-align">
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596" />
        </svg>
        <span class="text-small">ä¸Šä¸€ç¯‡</span>
      </div>
      <div>ä¸´æ±Ÿä»™</div>
    </a>
  
  <div class="vhr"></div>
  
    <div class="post-nav-item-right"></div>
  
</div>

    
      <div class="related-post">
  <div class="related__head">
  <a href="/tags/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/" class="post-tag">#ç§»åŠ¨å®‰å…¨</a>

</div>
  <div class="realated__body">
    
      <div class="null"><div class="null-item"><div class="null-title"><a href="\2025\07\25\360åŠ å›ºä¿å…è´¹ç‰ˆ\" title="360åŠ å›ºä¿å…è´¹ç‰ˆåˆ†æ" rel="bookmark">360åŠ å›ºä¿å…è´¹ç‰ˆåˆ†æ</a></div></div><div class="null-item"><div class="null-title"><a href="\2025\10\15\Nativeå‡½æ•°æ³¨å†Œ\" title="å®‰å“Nativeå±‚å‡½æ•°æ³¨å†Œ" rel="bookmark">å®‰å“Nativeå±‚å‡½æ•°æ³¨å†Œ</a></div></div><div class="null-item"><div class="null-title"><a href="\2024\07\25\DASCTF2024å¤å­£æŒ‘æˆ˜èµ›-StrangePrograme\" title="[DASCTF2024å¤å­£æŒ‘æˆ˜èµ›]StrangePrograme" rel="bookmark">[DASCTF2024å¤å­£æŒ‘æˆ˜èµ›]StrangePrograme</a></div></div></div>
    
  </div>
</div>

    
    
  </div>

    </div>
    <div class="foot">
      <div class="foot-inner">
        <div class="foot__head">
          
            <div class="foot-line">
              <div class="matts">å¤</div><div class="matts">ä»Š</div><div class="matts">å¤š</div><div class="matts">å°‘</div><div class="matts">äº‹</div>
            </div>
          
            <div class="foot-line">
              <div class="matts">éƒ½</div><div class="matts">ä»˜</div><div class="matts">ç¬‘</div><div class="matts">è°ˆ</div><div class="matts">ä¸­</div>
            </div>
          
        </div>
        <div class="foot__body">
          
            <div class="foot-item">
              <div class="foot-item__head">æœ‹å‹</div>
              <div class="foot-item__body">
                
                  <div class="text">
                    <img alt="link" height="20px" width="20px" src="/images/icon/icon-link.svg" />
                    <a class="foot-link" target="_blank" rel="noopener" href="https://fairy-10124.github.io">æ§åºåä¸ƒ</a>
                  </div>
                
                <div class="text">
                  <img alt="link" height="20px" width="20px" src="/images/icon/icon-link+.svg" />
                  <a class="foot-link"
                     href="mailto:nr38six@foxmail.com?subject=%E7%94%B3%E8%AF%B7%20Hozen.site%20%E7%9A%84%E5%8F%8B%E9%93%BE%E4%BD%8D%E7%BD%AE">
                  ç”³è¯·å‹é“¾</a>
                </div>
              </div>
            </div>
          
          
          <div class="foot-item">
            <div class="foot-item__head">è”ç³»</div>
            <div class="foot-item__body">
              <div class="text">
                <img alt="link" height="20px" width="20px" src="/images/icon/icon-email.svg" />
                <a class="foot-link" href="mailto:nr38six@foxmail.com">nr38six@foxmail.com</a>
              </div>
            </div>
          </div>
        </div>
        <div class="copyright">
          <a href="http://f10ower.github.io">ä¸´æ±Ÿä»™çš„èŠ±é—´é˜</a> &nbsp;|&nbsp;ç”±&nbsp;<a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>&nbsp;åŠ&nbsp;
          <svg width="20" height="20" viewBox="0 0 725 725">
            <path fill-rule="evenodd" fill="rgb(221, 221, 221)" d="M145.870,236.632 L396.955,103.578 L431.292,419.44 L156.600,522.53 L145.870,236.632 Z" />
            <path fill-rule="evenodd" fill="rgb(159, 159, 159)" d="M396.955,103.578 L564.345,234.486 L611.558,513.469 L431.292,419.44 L396.955,103.578 Z" />
            <path fill-rule="evenodd" fill="rgb(0, 0, 0)" d="M431.292,419.44 L611.558,513.469 L358.327,595.18 L156.600,522.53 L431.292,419.44 Z" />
          </svg>
          <a target="_blank" rel="noopener" href="https://github.com/hooozen/hexo-theme-tranquility">è‡´è¿œ</a>&nbsp;é©±åŠ¨
        </div>
      </div>
    </div>
    
    
      <script src="/js/search.js"></script>
      <script>searchInitialize("/search.json")</script>
    
    
  

  </body>
</html>
